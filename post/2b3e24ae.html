<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="format-detection" content="telephone=no"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><link rel="icon" href="/images/icons/favicon-16x16.png?v=2.6.2" type="image/png" sizes="16x16"><link rel="icon" href="/images/icons/favicon-32x32.png?v=2.6.2" type="image/png" sizes="32x32"><meta name="google-site-verification" content="CI1jqQ3Mhk0QSn61VHhjaeopJ0djgDy0IU_65qfQqiQ"><meta name="msvalidate.01" content="87144E235564BBBA9FFE3F19C36EEC0A"><meta name="baidu-site-verification" content="code-2yY2VTJ1Zi"><meta name="360-site-verification" content="479be47aa29500f8aeb1b40a9a67026f"><meta name="description" content="iText(PDF操作工具)入门手册">
<meta property="og:type" content="article">
<meta property="og:title" content="iText入门手册">
<meta property="og:url" content="http://garfielder.com/post/2b3e24ae.html">
<meta property="og:site_name" content="Garfield Blog">
<meta property="og:description" content="iText(PDF操作工具)入门手册">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2021-08-27T06:58:11.000Z">
<meta property="article:modified_time" content="2021-08-27T07:16:14.721Z">
<meta property="article:author" content="Garfield">
<meta property="article:tag" content="iText">
<meta property="article:tag" content="Java">
<meta name="twitter:card" content="summary"><title>iText入门手册 | Garfield Blog</title><link ref="canonical" href="http://garfielder.com/post/2b3e24ae.html"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.12.1/css/all.min.css" type="text/css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" type="text/css"><link rel="stylesheet" href="/css/index.css?v=2.6.2"><link rel="dns-prefetch" href="https://hm.baidu.com"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement('script');
  hm.src = 'https://hm.baidu.com/hm.js?225e5d3b94db0afd1e42a378e377cbfb';
  hm.async = true;

  if (true) {
    hm.setAttribute('data-pjax', '');
  }
  var s = document.getElementsByTagName('script')[0]; 
  s.parentNode.insertBefore(hm, s);
})();</script><script>var Stun = window.Stun || {};
var CONFIG = {
  root: '/',
  algolia: undefined,
  assistSearch: undefined,
  fontIcon: {"prompt":{"success":"fas fa-check-circle","info":"fas fa-arrow-circle-right","warning":"fas fa-exclamation-circle","error":"fas fa-times-circle"},"copyBtn":"fas fa-copy"},
  sidebar: {"offsetTop":"20px","tocMaxDepth":6},
  header: {"enable":true,"showOnPost":false,"scrollDownIcon":true},
  postWidget: {"endText":true},
  nightMode: {"enable":true},
  back2top: {"enable":true},
  codeblock: {"style":"carbon","highlight":"light","wordWrap":false},
  reward: false,
  fancybox: true,
  zoomImage: {"gapAside":"20px"},
  galleryWaterfall: undefined,
  lazyload: true,
  pjax: {"avoidBanner":false},
  externalLink: {"icon":{"enable":true,"name":"fas fa-external-link-alt"}},
  shortcuts: undefined,
  prompt: {"copyButton":"复制","copySuccess":"复制成功","copyError":"复制失败"},
  sourcePath: {"js":"js","css":"css","images":"images"},
};

window.CONFIG = CONFIG;</script><meta name="generator" content="Hexo 5.4.0"></head><body><div class="container" id="container"><header class="header" id="header"><div class="header-inner header-inner--height header-inner--bgcolor"><nav class="header-nav header-nav--sticky"><div class="header-nav-inner"><div class="header-nav-menubtn"><i class="fas fa-bars"></i></div><div class="header-nav-menu"><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/"><span class="header-nav-menu-item__icon"><i class="fas fa-home"></i></span><span class="header-nav-menu-item__text">首页</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="javascript:;" onclick="return false;"><span class="header-nav-menu-item__icon"><i class="fas fa-book"></i></span><span class="header-nav-menu-item__text">文章</span></a><div class="header-nav-submenu"><div class="header-nav-submenu-item"><a class="header-nav-submenu-item__link" href="/archives/"><span class="header-nav-submenu-item__icon"><i class="fas fa-folder-open"></i></span><span class="header-nav-submenu-item__text">归档</span></a></div><div class="header-nav-submenu-item"><a class="header-nav-submenu-item__link" href="/categories/"><span class="header-nav-submenu-item__icon"><i class="fas fa-layer-group"></i></span><span class="header-nav-submenu-item__text">分类</span></a></div><div class="header-nav-submenu-item"><a class="header-nav-submenu-item__link" href="/tags/"><span class="header-nav-submenu-item__icon"><i class="fas fa-tags"></i></span><span class="header-nav-submenu-item__text">标签</span></a></div></div></div></div><div class="header-nav-search"><span class="header-nav-search__icon"><i class="fas fa-search"></i></span><span class="header-nav-search__text">搜索</span></div><div class="header-nav-mode"><div class="mode"><div class="mode-track"><span class="mode-track-moon"></span><span class="mode-track-sun"></span></div><div class="mode-thumb"></div></div></div></div></nav></div></header><main class="main" id="main"><div class="main-inner"><div class="content-wrap" id="content-wrap"><div class="content" id="content"><!-- Just used to judge whether it is an article page--><div id="is-post"></div><div class="post"><header class="post-header"><h1 class="post-title">iText入门手册</h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">发表于</span><span class="post-meta-item__value">2021-08-27</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">更新于</span><span class="post-meta-item__value">2021-08-27</span></span><span class="post-meta-item post-meta-item--wordcount"><span class="post-meta-item__icon"><i class="far fa-file-word"></i></span><span class="post-meta-item__info">字数统计</span><span class="post-meta-item__value">3.9k</span></span><span class="post-meta-item post-meta-item--readtime"><span class="post-meta-item__icon"><i class="far fa-clock"></i></span><span class="post-meta-item__info">阅读时长</span><span class="post-meta-item__value">45分</span></span><span class="post-meta-item post-meta-item--visitors"><span class="post-meta-item__icon"><i class="fas fa-eye"></i></span><span class="post-meta-item__info">阅读次数</span><span class="post-meta-item__value" id="busuanzi_value_page_pv"></span></span></div></header><div class="post-body">
        <h3 id="介绍"   >
          <a href="#介绍" class="heading-link"><i class="fas fa-link"></i></a><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h3>
      <p><code>iText</code>是著名的开放项目，是用于生成<code>PDF</code>文档的一个<code>Java</code>类库。通过<code>iText</code>不仅可以生成<code>PDF</code>或<code>rtf</code>的文档，而且可以将<code>XML</code>、<code>Html</code>文件转化为<code>PDF</code>文件。访问<span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="http://itextpdf.com/" >官网</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>。</p>

        <h3 id="入门教程"   >
          <a href="#入门教程" class="heading-link"><i class="fas fa-link"></i></a><a href="#入门教程" class="headerlink" title="入门教程"></a>入门教程</h3>
      
        <h4 id="生成一个PDF"   >
          <a href="#生成一个PDF" class="heading-link"><i class="fas fa-link"></i></a><a href="#生成一个PDF" class="headerlink" title="生成一个PDF"></a>生成一个<code>PDF</code></h4>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Step 1—Create a Document.  </span></span><br><span class="line">Document document = <span class="keyword">new</span> Document();  </span><br><span class="line"><span class="comment">//Step 2—Get a PdfWriter instance.  </span></span><br><span class="line">PdfWriter.getInstance(document, <span class="keyword">new</span> FileOutputStream(FILE_DIR + <span class="string">&quot;createSamplePDF.pdf&quot;</span>)); </span><br><span class="line"></span><br><span class="line"><span class="comment">//Step 3—Open the Document.  </span></span><br><span class="line">document.open();  </span><br><span class="line"><span class="comment">//Step 4—Add content.  </span></span><br><span class="line">document.add(<span class="keyword">new</span> Paragraph(<span class="string">&quot;Hello World&quot;</span>));  </span><br><span class="line"><span class="comment">//Step 5—Close the Document.  </span></span><br><span class="line">document.close();  </span><br></pre></td></tr></table></div></figure>


        <h4 id="页面大小、页面背景色、页边空白、Title、Author、Subject、Keywords"   >
          <a href="#页面大小、页面背景色、页边空白、Title、Author、Subject、Keywords" class="heading-link"><i class="fas fa-link"></i></a><a href="#页面大小、页面背景色、页边空白、Title、Author、Subject、Keywords" class="headerlink" title="页面大小、页面背景色、页边空白、Title、Author、Subject、Keywords"></a>页面大小、页面背景色、页边空白、Title、Author、Subject、Keywords</h4>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//页面大小  </span></span><br><span class="line">Rectangle rect = <span class="keyword">new</span> Rectangle(PageSize.B5.rotate());  </span><br><span class="line"><span class="comment">//页面背景色  </span></span><br><span class="line">rect.setBackgroundColor(BaseColor.ORANGE);  </span><br><span class="line">  </span><br><span class="line">Document doc = <span class="keyword">new</span> Document(rect);  </span><br><span class="line">  </span><br><span class="line">PdfWriter writer = PdfWriter.getInstance(doc, out);  </span><br><span class="line">  </span><br><span class="line"><span class="comment">//PDF版本(默认1.4)  </span></span><br><span class="line">writer.setPdfVersion(PdfWriter.PDF_VERSION_1_2);  </span><br><span class="line">  </span><br><span class="line"><span class="comment">//文档属性  </span></span><br><span class="line">doc.addTitle(<span class="string">&quot;Title@sample&quot;</span>);  </span><br><span class="line">doc.addAuthor(<span class="string">&quot;Author@rensanning&quot;</span>);  </span><br><span class="line">doc.addSubject(<span class="string">&quot;Subject@iText sample&quot;</span>);  </span><br><span class="line">doc.addKeywords(<span class="string">&quot;Keywords@iText&quot;</span>);  </span><br><span class="line">doc.addCreator(<span class="string">&quot;Creator@iText&quot;</span>);  </span><br><span class="line">  </span><br><span class="line"><span class="comment">//页边空白  </span></span><br><span class="line">doc.setMargins(<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>, <span class="number">40</span>);  </span><br><span class="line">  </span><br><span class="line">doc.open();  </span><br><span class="line">doc.add(<span class="keyword">new</span> Paragraph(<span class="string">&quot;Hello World&quot;</span>));</span><br></pre></td></tr></table></div></figure>


        <h4 id="设置密码"   >
          <a href="#设置密码" class="heading-link"><i class="fas fa-link"></i></a><a href="#设置密码" class="headerlink" title="设置密码"></a>设置密码</h4>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">PdfWriter writer = PdfWriter.getInstance(doc, out);  </span><br><span class="line">  </span><br><span class="line"><span class="comment">// 设置密码为：&quot;World&quot;  </span></span><br><span class="line">writer.setEncryption(<span class="string">&quot;Hello&quot;</span>.getBytes(), <span class="string">&quot;World&quot;</span>.getBytes(),  </span><br><span class="line">        PdfWriter.ALLOW_SCREENREADERS,  </span><br><span class="line">        PdfWriter.STANDARD_ENCRYPTION_128);  </span><br><span class="line">  </span><br><span class="line">doc.open();  </span><br><span class="line">doc.add(<span class="keyword">new</span> Paragraph(<span class="string">&quot;Hello World&quot;</span>));</span><br></pre></td></tr></table></div></figure>


        <h4 id="添加Page"   >
          <a href="#添加Page" class="heading-link"><i class="fas fa-link"></i></a><a href="#添加Page" class="headerlink" title="添加Page"></a>添加Page</h4>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">document.open();  </span><br><span class="line">document.add(<span class="keyword">new</span> Paragraph(<span class="string">&quot;First page&quot;</span>));  </span><br><span class="line">document.add(<span class="keyword">new</span> Paragraph(Document.getVersion()));  </span><br><span class="line">  </span><br><span class="line">document.newPage();  </span><br><span class="line">writer.setPageEmpty(<span class="keyword">false</span>);  </span><br><span class="line">  </span><br><span class="line">document.newPage();  </span><br><span class="line">document.add(<span class="keyword">new</span> Paragraph(<span class="string">&quot;New page&quot;</span>));</span><br></pre></td></tr></table></div></figure>


        <h4 id="添加水印"   >
          <a href="#添加水印" class="heading-link"><i class="fas fa-link"></i></a><a href="#添加水印" class="headerlink" title="添加水印"></a>添加水印</h4>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//图片水印  </span></span><br><span class="line">PdfReader reader = <span class="keyword">new</span> PdfReader(FILE_DIR + <span class="string">&quot;setWatermark.pdf&quot;</span>);  </span><br><span class="line">PdfStamper stamp = <span class="keyword">new</span> PdfStamper(reader, <span class="keyword">new</span> FileOutputStream(FILE_DIR  </span><br><span class="line">        + <span class="string">&quot;setWatermark2.pdf&quot;</span>));  </span><br><span class="line">  </span><br><span class="line">Image img = Image.getInstance(<span class="string">&quot;resource/watermark.jpg&quot;</span>);  </span><br><span class="line">img.setAbsolutePosition(<span class="number">200</span>, <span class="number">400</span>);  </span><br><span class="line">PdfContentByte under = stamp.getUnderContent(<span class="number">1</span>);  </span><br><span class="line">under.addImage(img);  </span><br><span class="line">  </span><br><span class="line"><span class="comment">//文字水印  </span></span><br><span class="line">PdfContentByte over = stamp.getOverContent(<span class="number">2</span>);  </span><br><span class="line">over.beginText();  </span><br><span class="line">BaseFont bf = BaseFont.createFont(BaseFont.HELVETICA, BaseFont.WINANSI,  </span><br><span class="line">        BaseFont.EMBEDDED);  </span><br><span class="line">over.setFontAndSize(bf, <span class="number">18</span>);  </span><br><span class="line">over.setTextMatrix(<span class="number">30</span>, <span class="number">30</span>);  </span><br><span class="line">over.showTextAligned(Element.ALIGN_LEFT, <span class="string">&quot;DUPLICATE&quot;</span>, <span class="number">230</span>, <span class="number">430</span>, <span class="number">45</span>);  </span><br><span class="line">over.endText();  </span><br><span class="line">  </span><br><span class="line"><span class="comment">//背景图  </span></span><br><span class="line">Image img2 = Image.getInstance(<span class="string">&quot;resource/test.jpg&quot;</span>);  </span><br><span class="line">img2.setAbsolutePosition(<span class="number">0</span>, <span class="number">0</span>);  </span><br><span class="line">PdfContentByte under2 = stamp.getUnderContent(<span class="number">3</span>);  </span><br><span class="line">under2.addImage(img2);  </span><br><span class="line">  </span><br><span class="line">stamp.close();  </span><br><span class="line">reader.close();  </span><br></pre></td></tr></table></div></figure>


        <h4 id="插入Chunk、Phrase、Paragraph、List"   >
          <a href="#插入Chunk、Phrase、Paragraph、List" class="heading-link"><i class="fas fa-link"></i></a><a href="#插入Chunk、Phrase、Paragraph、List" class="headerlink" title="插入Chunk、Phrase、Paragraph、List"></a>插入Chunk、Phrase、Paragraph、List</h4>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Chunk对象: a String, a Font, and some attributes  </span></span><br><span class="line">document.add(<span class="keyword">new</span> Chunk(<span class="string">&quot;China&quot;</span>));  </span><br><span class="line">document.add(<span class="keyword">new</span> Chunk(<span class="string">&quot; &quot;</span>));  </span><br><span class="line">Font font = <span class="keyword">new</span> Font(Font.FontFamily.HELVETICA, <span class="number">6</span>, Font.BOLD, BaseColor.WHITE);  </span><br><span class="line">Chunk id = <span class="keyword">new</span> Chunk(<span class="string">&quot;chinese&quot;</span>, font);  </span><br><span class="line">id.setBackground(BaseColor.BLACK, <span class="number">1f</span>, <span class="number">0.5f</span>, <span class="number">1f</span>, <span class="number">1.5f</span>);  </span><br><span class="line">id.setTextRise(<span class="number">6</span>);  </span><br><span class="line">document.add(id);  </span><br><span class="line">document.add(Chunk.NEWLINE);  </span><br><span class="line">  </span><br><span class="line">document.add(<span class="keyword">new</span> Chunk(<span class="string">&quot;Japan&quot;</span>));  </span><br><span class="line">document.add(<span class="keyword">new</span> Chunk(<span class="string">&quot; &quot;</span>));  </span><br><span class="line">Font font2 = <span class="keyword">new</span> Font(Font.FontFamily.HELVETICA, <span class="number">6</span>, Font.BOLD, BaseColor.WHITE);  </span><br><span class="line">Chunk id2 = <span class="keyword">new</span> Chunk(<span class="string">&quot;japanese&quot;</span>, font2);  </span><br><span class="line">id2.setBackground(BaseColor.BLACK, <span class="number">1f</span>, <span class="number">0.5f</span>, <span class="number">1f</span>, <span class="number">1.5f</span>);  </span><br><span class="line">id2.setTextRise(<span class="number">6</span>);  </span><br><span class="line">id2.setUnderline(<span class="number">0.2f</span>, -<span class="number">2f</span>);  </span><br><span class="line">document.add(id2);  </span><br><span class="line">document.add(Chunk.NEWLINE);  </span><br><span class="line">  </span><br><span class="line"><span class="comment">//Phrase对象: a List of Chunks with leading  </span></span><br><span class="line">document.newPage();  </span><br><span class="line">document.add(<span class="keyword">new</span> Phrase(<span class="string">&quot;Phrase page&quot;</span>));  </span><br><span class="line">  </span><br><span class="line">Phrase director = <span class="keyword">new</span> Phrase();  </span><br><span class="line">Chunk name = <span class="keyword">new</span> Chunk(<span class="string">&quot;China&quot;</span>);  </span><br><span class="line">name.setUnderline(<span class="number">0.2f</span>, -<span class="number">2f</span>);  </span><br><span class="line">director.add(name);  </span><br><span class="line">director.add(<span class="keyword">new</span> Chunk(<span class="string">&quot;,&quot;</span>));  </span><br><span class="line">director.add(<span class="keyword">new</span> Chunk(<span class="string">&quot; &quot;</span>));  </span><br><span class="line">director.add(<span class="keyword">new</span> Chunk(<span class="string">&quot;chinese&quot;</span>));  </span><br><span class="line">director.setLeading(<span class="number">24</span>);  </span><br><span class="line">document.add(director);  </span><br><span class="line">  </span><br><span class="line">Phrase director2 = <span class="keyword">new</span> Phrase();  </span><br><span class="line">Chunk name2 = <span class="keyword">new</span> Chunk(<span class="string">&quot;Japan&quot;</span>);  </span><br><span class="line">name2.setUnderline(<span class="number">0.2f</span>, -<span class="number">2f</span>);  </span><br><span class="line">director2.add(name2);  </span><br><span class="line">director2.add(<span class="keyword">new</span> Chunk(<span class="string">&quot;,&quot;</span>));  </span><br><span class="line">director2.add(<span class="keyword">new</span> Chunk(<span class="string">&quot; &quot;</span>));  </span><br><span class="line">director2.add(<span class="keyword">new</span> Chunk(<span class="string">&quot;japanese&quot;</span>));  </span><br><span class="line">director2.setLeading(<span class="number">24</span>);  </span><br><span class="line">document.add(director2);  </span><br><span class="line">          </span><br><span class="line"><span class="comment">//Paragraph对象: a Phrase with extra properties and a newline  </span></span><br><span class="line">document.newPage();  </span><br><span class="line">document.add(<span class="keyword">new</span> Paragraph(<span class="string">&quot;Paragraph page&quot;</span>));  </span><br><span class="line">  </span><br><span class="line">Paragraph info = <span class="keyword">new</span> Paragraph();  </span><br><span class="line">info.add(<span class="keyword">new</span> Chunk(<span class="string">&quot;China &quot;</span>));  </span><br><span class="line">info.add(<span class="keyword">new</span> Chunk(<span class="string">&quot;chinese&quot;</span>));  </span><br><span class="line">info.add(Chunk.NEWLINE);  </span><br><span class="line">info.add(<span class="keyword">new</span> Phrase(<span class="string">&quot;Japan &quot;</span>));  </span><br><span class="line">info.add(<span class="keyword">new</span> Phrase(<span class="string">&quot;japanese&quot;</span>));  </span><br><span class="line">document.add(info);  </span><br><span class="line">  </span><br><span class="line"><span class="comment">//List对象: a sequence of Paragraphs called ListItem  </span></span><br><span class="line">document.newPage();  </span><br><span class="line">List list = <span class="keyword">new</span> List(List.ORDERED);  </span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;  </span><br><span class="line">    ListItem item = <span class="keyword">new</span> ListItem(String.format(<span class="string">&quot;%s: %d movies&quot;</span>,  </span><br><span class="line">            <span class="string">&quot;country&quot;</span> + (i + <span class="number">1</span>), (i + <span class="number">1</span>) * <span class="number">100</span>), <span class="keyword">new</span> Font(  </span><br><span class="line">            Font.FontFamily.HELVETICA, <span class="number">6</span>, Font.BOLD, BaseColor.WHITE));  </span><br><span class="line">    List movielist = <span class="keyword">new</span> List(List.ORDERED, List.ALPHABETICAL);  </span><br><span class="line">    movielist.setLowercase(List.LOWERCASE);  </span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">5</span>; j++) &#123;  </span><br><span class="line">        ListItem movieitem = <span class="keyword">new</span> ListItem(<span class="string">&quot;Title&quot;</span> + (j + <span class="number">1</span>));  </span><br><span class="line">        List directorlist = <span class="keyword">new</span> List(List.UNORDERED);  </span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; <span class="number">3</span>; k++) &#123;  </span><br><span class="line">            directorlist.add(String.format(<span class="string">&quot;%s, %s&quot;</span>, <span class="string">&quot;Name1&quot;</span> + (k + <span class="number">1</span>),  </span><br><span class="line">                    <span class="string">&quot;Name2&quot;</span> + (k + <span class="number">1</span>)));  </span><br><span class="line">        &#125;  </span><br><span class="line">        movieitem.add(directorlist);  </span><br><span class="line">        movielist.add(movieitem);  </span><br><span class="line">    &#125;  </span><br><span class="line">    item.add(movielist);  </span><br><span class="line">    list.add(item);  </span><br><span class="line">&#125;  </span><br><span class="line">document.add(list);</span><br></pre></td></tr></table></div></figure>


        <h4 id="插入Anchor、Image、Chapter、Section"   >
          <a href="#插入Anchor、Image、Chapter、Section" class="heading-link"><i class="fas fa-link"></i></a><a href="#插入Anchor、Image、Chapter、Section" class="headerlink" title="插入Anchor、Image、Chapter、Section"></a>插入Anchor、Image、Chapter、Section</h4>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Anchor对象: internal and external links  </span></span><br><span class="line">Paragraph country = <span class="keyword">new</span> Paragraph();  </span><br><span class="line">Anchor dest = <span class="keyword">new</span> Anchor(<span class="string">&quot;china&quot;</span>, <span class="keyword">new</span> Font(Font.FontFamily.HELVETICA, <span class="number">14</span>, Font.BOLD, BaseColor.BLUE));  </span><br><span class="line">dest.setName(<span class="string">&quot;CN&quot;</span>);  </span><br><span class="line">dest.setReference(<span class="string">&quot;http://www.china.com&quot;</span>);<span class="comment">//external  </span></span><br><span class="line">country.add(dest);  </span><br><span class="line">country.add(String.format(<span class="string">&quot;: %d sites&quot;</span>, <span class="number">10000</span>));  </span><br><span class="line">document.add(country);  </span><br><span class="line">  </span><br><span class="line">document.newPage();  </span><br><span class="line">Anchor toUS = <span class="keyword">new</span> Anchor(<span class="string">&quot;Go to first page.&quot;</span>, <span class="keyword">new</span> Font(Font.FontFamily.HELVETICA, <span class="number">14</span>, Font.BOLD, BaseColor.BLUE));  </span><br><span class="line">toUS.setReference(<span class="string">&quot;#CN&quot;</span>);<span class="comment">//internal  </span></span><br><span class="line">document.add(toUS);  </span><br><span class="line">  </span><br><span class="line"><span class="comment">//Image对象  </span></span><br><span class="line">document.newPage();  </span><br><span class="line">Image img = Image.getInstance(<span class="string">&quot;resource/test.jpg&quot;</span>);  </span><br><span class="line">img.setAlignment(Image.LEFT | Image.TEXTWRAP);  </span><br><span class="line">img.setBorder(Image.BOX);  </span><br><span class="line">img.setBorderWidth(<span class="number">10</span>);  </span><br><span class="line">img.setBorderColor(BaseColor.WHITE);  </span><br><span class="line">img.scaleToFit(<span class="number">1000</span>, <span class="number">72</span>);<span class="comment">//大小  </span></span><br><span class="line">img.setRotationDegrees(-<span class="number">30</span>);<span class="comment">//旋转  </span></span><br><span class="line">document.add(img);  </span><br><span class="line">  </span><br><span class="line"><span class="comment">//Chapter, Section对象（目录）  </span></span><br><span class="line">document.newPage();  </span><br><span class="line">Paragraph title = <span class="keyword">new</span> Paragraph(<span class="string">&quot;Title&quot;</span>);  </span><br><span class="line">Chapter chapter = <span class="keyword">new</span> Chapter(title, <span class="number">1</span>);  </span><br><span class="line">  </span><br><span class="line">title = <span class="keyword">new</span> Paragraph(<span class="string">&quot;Section A&quot;</span>);  </span><br><span class="line">Section section = chapter.addSection(title);  </span><br><span class="line">section.setBookmarkTitle(<span class="string">&quot;bmk&quot;</span>);  </span><br><span class="line">section.setIndentation(<span class="number">30</span>);  </span><br><span class="line">section.setBookmarkOpen(<span class="keyword">false</span>);  </span><br><span class="line">section.setNumberStyle(  </span><br><span class="line">Section.NUMBERSTYLE_DOTTED_WITHOUT_FINAL_DOT);  </span><br><span class="line">  </span><br><span class="line">Section subsection = section.addSection(<span class="keyword">new</span> Paragraph(<span class="string">&quot;Sub Section A&quot;</span>));  </span><br><span class="line">subsection.setIndentationLeft(<span class="number">20</span>);  </span><br><span class="line">subsection.setNumberDepth(<span class="number">1</span>);  </span><br><span class="line">  </span><br><span class="line">document.add(chapter);</span><br></pre></td></tr></table></div></figure>


        <h4 id="画图"   >
          <a href="#画图" class="heading-link"><i class="fas fa-link"></i></a><a href="#画图" class="headerlink" title="画图"></a>画图</h4>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//左右箭头  </span></span><br><span class="line">document.add(<span class="keyword">new</span> VerticalPositionMark() &#123;  </span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">draw</span><span class="params">(PdfContentByte canvas, <span class="keyword">float</span> llx, <span class="keyword">float</span> lly,  </span></span></span><br><span class="line"><span class="function"><span class="params">            <span class="keyword">float</span> urx, <span class="keyword">float</span> ury, <span class="keyword">float</span> y)</span> </span>&#123;  </span><br><span class="line">        canvas.beginText();  </span><br><span class="line">        BaseFont bf = <span class="keyword">null</span>;  </span><br><span class="line">        <span class="keyword">try</span> &#123;  </span><br><span class="line">            bf = BaseFont.createFont(BaseFont.ZAPFDINGBATS, <span class="string">&quot;&quot;</span>, BaseFont.EMBEDDED);  </span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;  </span><br><span class="line">            e.printStackTrace();  </span><br><span class="line">        &#125;  </span><br><span class="line">        canvas.setFontAndSize(bf, <span class="number">12</span>);  </span><br><span class="line">          </span><br><span class="line">        <span class="comment">// LEFT  </span></span><br><span class="line">        canvas.showTextAligned(Element.ALIGN_CENTER, String.valueOf((<span class="keyword">char</span>) <span class="number">220</span>), llx - <span class="number">10</span>, y, <span class="number">0</span>);  </span><br><span class="line">        <span class="comment">// RIGHT  </span></span><br><span class="line">        canvas.showTextAligned(Element.ALIGN_CENTER, String.valueOf((<span class="keyword">char</span>) <span class="number">220</span>), urx + <span class="number">10</span>, y + <span class="number">8</span>, <span class="number">180</span>);  </span><br><span class="line">          </span><br><span class="line">        canvas.endText();  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;);  </span><br><span class="line">  </span><br><span class="line"><span class="comment">//直线  </span></span><br><span class="line">Paragraph p1 = <span class="keyword">new</span> Paragraph(<span class="string">&quot;LEFT&quot;</span>);  </span><br><span class="line">p1.add(<span class="keyword">new</span> Chunk(<span class="keyword">new</span> LineSeparator()));  </span><br><span class="line">p1.add(<span class="string">&quot;R&quot;</span>);  </span><br><span class="line">document.add(p1);  </span><br><span class="line"><span class="comment">//点线  </span></span><br><span class="line">Paragraph p2 = <span class="keyword">new</span> Paragraph(<span class="string">&quot;LEFT&quot;</span>);  </span><br><span class="line">p2.add(<span class="keyword">new</span> Chunk(<span class="keyword">new</span> DottedLineSeparator()));  </span><br><span class="line">p2.add(<span class="string">&quot;R&quot;</span>);  </span><br><span class="line">document.add(p2);  </span><br><span class="line"><span class="comment">//下滑线  </span></span><br><span class="line">LineSeparator UNDERLINE = <span class="keyword">new</span> LineSeparator(<span class="number">1</span>, <span class="number">100</span>, <span class="keyword">null</span>, Element.ALIGN_CENTER, -<span class="number">2</span>);  </span><br><span class="line">Paragraph p3 = <span class="keyword">new</span> Paragraph(<span class="string">&quot;NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN&quot;</span>);  </span><br><span class="line">p3.add(UNDERLINE);  </span><br><span class="line">document.add(p3);  </span><br></pre></td></tr></table></div></figure>


        <h4 id="设置段落"   >
          <a href="#设置段落" class="heading-link"><i class="fas fa-link"></i></a><a href="#设置段落" class="headerlink" title="设置段落"></a>设置段落</h4>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">Paragraph p = <span class="keyword">new</span> Paragraph(<span class="string">&quot;In the previous example, you added a header and footer with the showTextAligned() method. This example demonstrates that it’s sometimes more interesting to use PdfPTable and writeSelectedRows(). You can define a bottom border for each cell so that the header is underlined. This is the most elegant way to add headers and footers, because the table mechanism allows you to position and align lines, images, and text.&quot;</span>);  </span><br><span class="line">  </span><br><span class="line"><span class="comment">//默认  </span></span><br><span class="line">p.setAlignment(Element.ALIGN_JUSTIFIED);  </span><br><span class="line">document.add(p);  </span><br><span class="line">  </span><br><span class="line">document.newPage();  </span><br><span class="line">p.setAlignment(Element.ALIGN_JUSTIFIED);  </span><br><span class="line">p.setIndentationLeft(<span class="number">1</span> * <span class="number">15f</span>);  </span><br><span class="line">p.setIndentationRight((<span class="number">5</span> - <span class="number">1</span>) * <span class="number">15f</span>);  </span><br><span class="line">document.add(p);  </span><br><span class="line">  </span><br><span class="line"><span class="comment">//居右  </span></span><br><span class="line">document.newPage();  </span><br><span class="line">p.setAlignment(Element.ALIGN_RIGHT);  </span><br><span class="line">p.setSpacingAfter(<span class="number">15f</span>);  </span><br><span class="line">document.add(p);  </span><br><span class="line">  </span><br><span class="line"><span class="comment">//居左  </span></span><br><span class="line">document.newPage();  </span><br><span class="line">p.setAlignment(Element.ALIGN_LEFT);  </span><br><span class="line">p.setSpacingBefore(<span class="number">15f</span>);  </span><br><span class="line">document.add(p);  </span><br><span class="line">  </span><br><span class="line"><span class="comment">//居中  </span></span><br><span class="line">document.newPage();  </span><br><span class="line">p.setAlignment(Element.ALIGN_CENTER);  </span><br><span class="line">p.setSpacingAfter(<span class="number">15f</span>);  </span><br><span class="line">p.setSpacingBefore(<span class="number">15f</span>);  </span><br><span class="line">document.add(p);</span><br></pre></td></tr></table></div></figure>


        <h4 id="删除Page"   >
          <a href="#删除Page" class="heading-link"><i class="fas fa-link"></i></a><a href="#删除Page" class="headerlink" title="删除Page"></a>删除Page</h4>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">FileOutputStream out = <span class="keyword">new</span> FileOutputStream(FILE_DIR + <span class="string">&quot;deletePage.pdf&quot;</span>);  </span><br><span class="line">  </span><br><span class="line">Document document = <span class="keyword">new</span> Document();  </span><br><span class="line">  </span><br><span class="line">PdfWriter writer = PdfWriter.getInstance(document, out);  </span><br><span class="line">  </span><br><span class="line">document.open();  </span><br><span class="line">document.add(<span class="keyword">new</span> Paragraph(<span class="string">&quot;First page&quot;</span>));  </span><br><span class="line">document.add(<span class="keyword">new</span> Paragraph(Document.getVersion()));  </span><br><span class="line">  </span><br><span class="line">document.newPage();  </span><br><span class="line">writer.setPageEmpty(<span class="keyword">false</span>);  </span><br><span class="line">  </span><br><span class="line">document.newPage();  </span><br><span class="line">document.add(<span class="keyword">new</span> Paragraph(<span class="string">&quot;New page&quot;</span>));  </span><br><span class="line">  </span><br><span class="line">document.close();  </span><br><span class="line">  </span><br><span class="line">PdfReader reader = <span class="keyword">new</span> PdfReader(FILE_DIR + <span class="string">&quot;deletePage.pdf&quot;</span>);  </span><br><span class="line">reader.selectPages(<span class="string">&quot;1,3&quot;</span>);  </span><br><span class="line">PdfStamper stamp = <span class="keyword">new</span> PdfStamper(reader, <span class="keyword">new</span> FileOutputStream(FILE_DIR  </span><br><span class="line">        + <span class="string">&quot;deletePage2.pdf&quot;</span>));  </span><br><span class="line">stamp.close();  </span><br><span class="line">reader.close();</span><br></pre></td></tr></table></div></figure>


        <h4 id="插入Page"   >
          <a href="#插入Page" class="heading-link"><i class="fas fa-link"></i></a><a href="#插入Page" class="headerlink" title="插入Page"></a>插入Page</h4>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">FileOutputStream out = <span class="keyword">new</span> FileOutputStream(FILE_DIR + <span class="string">&quot;insertPage.pdf&quot;</span>);  </span><br><span class="line">  </span><br><span class="line">Document document = <span class="keyword">new</span> Document();  </span><br><span class="line">  </span><br><span class="line">PdfWriter.getInstance(document, out);  </span><br><span class="line">  </span><br><span class="line">document.open();  </span><br><span class="line">document.add(<span class="keyword">new</span> Paragraph(<span class="string">&quot;1 page&quot;</span>));  </span><br><span class="line">  </span><br><span class="line">document.newPage();  </span><br><span class="line">document.add(<span class="keyword">new</span> Paragraph(<span class="string">&quot;2 page&quot;</span>));  </span><br><span class="line">  </span><br><span class="line">document.newPage();  </span><br><span class="line">document.add(<span class="keyword">new</span> Paragraph(<span class="string">&quot;3 page&quot;</span>));  </span><br><span class="line">  </span><br><span class="line">document.close();  </span><br><span class="line">  </span><br><span class="line">PdfReader reader = <span class="keyword">new</span> PdfReader(FILE_DIR + <span class="string">&quot;insertPage.pdf&quot;</span>);  </span><br><span class="line">PdfStamper stamp = <span class="keyword">new</span> PdfStamper(reader, <span class="keyword">new</span> FileOutputStream(FILE_DIR  </span><br><span class="line">        + <span class="string">&quot;insertPage2.pdf&quot;</span>));  </span><br><span class="line">  </span><br><span class="line">stamp.insertPage(<span class="number">2</span>, reader.getPageSize(<span class="number">1</span>));  </span><br><span class="line">  </span><br><span class="line">ColumnText ct = <span class="keyword">new</span> ColumnText(<span class="keyword">null</span>);  </span><br><span class="line">ct.addElement(<span class="keyword">new</span> Paragraph(<span class="number">24</span>, <span class="keyword">new</span> Chunk(<span class="string">&quot;INSERT PAGE&quot;</span>)));  </span><br><span class="line">ct.setCanvas(stamp.getOverContent(<span class="number">2</span>));  </span><br><span class="line">ct.setSimpleColumn(<span class="number">36</span>, <span class="number">36</span>, <span class="number">559</span>, <span class="number">770</span>);  </span><br><span class="line">  </span><br><span class="line">stamp.close();  </span><br><span class="line">reader.close();</span><br></pre></td></tr></table></div></figure>


        <h4 id="排序Page"   >
          <a href="#排序Page" class="heading-link"><i class="fas fa-link"></i></a><a href="#排序Page" class="headerlink" title="排序Page"></a>排序Page</h4>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">PdfWriter writer = PdfWriter.getInstance(doc, out);  </span><br><span class="line">writer.setLinearPageMode();  </span><br><span class="line">  </span><br><span class="line">doc.open();  </span><br><span class="line">doc.add(<span class="keyword">new</span> Paragraph(<span class="string">&quot;1 page&quot;</span>));  </span><br><span class="line">doc.newPage();  </span><br><span class="line">doc.add(<span class="keyword">new</span> Paragraph(<span class="string">&quot;2 page&quot;</span>));  </span><br><span class="line">doc.newPage();  </span><br><span class="line">doc.add(<span class="keyword">new</span> Paragraph(<span class="string">&quot;3 page&quot;</span>));  </span><br><span class="line">doc.newPage();  </span><br><span class="line">doc.add(<span class="keyword">new</span> Paragraph(<span class="string">&quot;4 page&quot;</span>));  </span><br><span class="line">doc.newPage();  </span><br><span class="line">doc.add(<span class="keyword">new</span> Paragraph(<span class="string">&quot;5 page&quot;</span>));  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">int</span>[] order = &#123;<span class="number">4</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">1</span>&#125;;  </span><br><span class="line">writer.reorderPages(order);</span><br></pre></td></tr></table></div></figure>


        <h4 id="目录"   >
          <a href="#目录" class="heading-link"><i class="fas fa-link"></i></a><a href="#目录" class="headerlink" title="目录"></a>目录</h4>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Code 1  </span></span><br><span class="line">document.add(<span class="keyword">new</span> Chunk(<span class="string">&quot;Chapter 1&quot;</span>).setLocalDestination(<span class="string">&quot;1&quot;</span>));  </span><br><span class="line">  </span><br><span class="line">document.newPage();  </span><br><span class="line">document.add(<span class="keyword">new</span> Chunk(<span class="string">&quot;Chapter 2&quot;</span>).setLocalDestination(<span class="string">&quot;2&quot;</span>));  </span><br><span class="line">document.add(<span class="keyword">new</span> Paragraph(<span class="keyword">new</span> Chunk(<span class="string">&quot;Sub 2.1&quot;</span>).setLocalDestination(<span class="string">&quot;2.1&quot;</span>)));  </span><br><span class="line">document.add(<span class="keyword">new</span> Paragraph(<span class="keyword">new</span> Chunk(<span class="string">&quot;Sub 2.2&quot;</span>).setLocalDestination(<span class="string">&quot;2.2&quot;</span>)));  </span><br><span class="line">  </span><br><span class="line">document.newPage();  </span><br><span class="line">document.add(<span class="keyword">new</span> Chunk(<span class="string">&quot;Chapter 3&quot;</span>).setLocalDestination(<span class="string">&quot;3&quot;</span>));  </span><br><span class="line">  </span><br><span class="line"><span class="comment">// Code 2  </span></span><br><span class="line">PdfContentByte cb = writer.getDirectContent();  </span><br><span class="line">PdfOutline root = cb.getRootOutline();  </span><br><span class="line">  </span><br><span class="line"><span class="comment">// Code 3  </span></span><br><span class="line"><span class="meta">@SuppressWarnings(&quot;unused&quot;)</span>  </span><br><span class="line">PdfOutline oline1 = <span class="keyword">new</span> PdfOutline(root, PdfAction.gotoLocalPage(<span class="string">&quot;1&quot;</span>, <span class="keyword">false</span>), <span class="string">&quot;Chapter 1&quot;</span>);  </span><br><span class="line">  </span><br><span class="line">PdfOutline oline2 = <span class="keyword">new</span> PdfOutline(root, PdfAction.gotoLocalPage(<span class="string">&quot;2&quot;</span>, <span class="keyword">false</span>), <span class="string">&quot;Chapter 2&quot;</span>);  </span><br><span class="line">oline2.setOpen(<span class="keyword">false</span>);  </span><br><span class="line">  </span><br><span class="line"><span class="meta">@SuppressWarnings(&quot;unused&quot;)</span>  </span><br><span class="line">PdfOutline oline2_1 = <span class="keyword">new</span> PdfOutline(oline2, PdfAction.gotoLocalPage(<span class="string">&quot;2.1&quot;</span>, <span class="keyword">false</span>), <span class="string">&quot;Sub 2.1&quot;</span>);  </span><br><span class="line"><span class="meta">@SuppressWarnings(&quot;unused&quot;)</span>  </span><br><span class="line">PdfOutline oline2_2 = <span class="keyword">new</span> PdfOutline(oline2, PdfAction.gotoLocalPage(<span class="string">&quot;2.2&quot;</span>, <span class="keyword">false</span>), <span class="string">&quot;Sub 2.2&quot;</span>);  </span><br><span class="line">  </span><br><span class="line"><span class="meta">@SuppressWarnings(&quot;unused&quot;)</span>  </span><br><span class="line">PdfOutline oline3 = <span class="keyword">new</span> PdfOutline(root, PdfAction.gotoLocalPage(<span class="string">&quot;3&quot;</span>, <span class="keyword">false</span>), <span class="string">&quot;Chapter 3&quot;</span>);</span><br></pre></td></tr></table></div></figure>


        <h4 id="Header、Footer"   >
          <a href="#Header、Footer" class="heading-link"><i class="fas fa-link"></i></a><a href="#Header、Footer" class="headerlink" title="Header、Footer"></a>Header、Footer</h4>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">PdfWriter writer = PdfWriter.getInstance(doc, <span class="keyword">new</span> FileOutputStream(FILE_DIR + <span class="string">&quot;setHeaderFooter.pdf&quot;</span>));  </span><br><span class="line">  </span><br><span class="line">writer.setPageEvent(<span class="keyword">new</span> PdfPageEventHelper() &#123;  </span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onEndPage</span><span class="params">(PdfWriter writer, Document document)</span> </span>&#123;  </span><br><span class="line">          </span><br><span class="line">        PdfContentByte cb = writer.getDirectContent();  </span><br><span class="line">        cb.saveState();  </span><br><span class="line">  </span><br><span class="line">        cb.beginText();  </span><br><span class="line">        BaseFont bf = <span class="keyword">null</span>;  </span><br><span class="line">        <span class="keyword">try</span> &#123;  </span><br><span class="line">            bf = BaseFont.createFont(BaseFont.HELVETICA, BaseFont.WINANSI, BaseFont.EMBEDDED);  </span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;  </span><br><span class="line">            e.printStackTrace();  </span><br><span class="line">        &#125;  </span><br><span class="line">        cb.setFontAndSize(bf, <span class="number">10</span>);  </span><br><span class="line">          </span><br><span class="line">        <span class="comment">//Header  </span></span><br><span class="line">        <span class="keyword">float</span> x = document.top(-<span class="number">20</span>);  </span><br><span class="line">          </span><br><span class="line">        <span class="comment">//左  </span></span><br><span class="line">        cb.showTextAligned(PdfContentByte.ALIGN_LEFT,  </span><br><span class="line">                           <span class="string">&quot;H-Left&quot;</span>,  </span><br><span class="line">                           document.left(), x, <span class="number">0</span>);  </span><br><span class="line">        <span class="comment">//中  </span></span><br><span class="line">        cb.showTextAligned(PdfContentByte.ALIGN_CENTER,  </span><br><span class="line">                            writer.getPageNumber()+ <span class="string">&quot; page&quot;</span>,  </span><br><span class="line">                           (document.right() + document.left())/<span class="number">2</span>,  </span><br><span class="line">                           x, <span class="number">0</span>);  </span><br><span class="line">        <span class="comment">//右  </span></span><br><span class="line">        cb.showTextAligned(PdfContentByte.ALIGN_RIGHT,  </span><br><span class="line">                           <span class="string">&quot;H-Right&quot;</span>,  </span><br><span class="line">                           document.right(), x, <span class="number">0</span>);  </span><br><span class="line">  </span><br><span class="line">        <span class="comment">//Footer  </span></span><br><span class="line">        <span class="keyword">float</span> y = document.bottom(-<span class="number">20</span>);  </span><br><span class="line">  </span><br><span class="line">        <span class="comment">//左  </span></span><br><span class="line">        cb.showTextAligned(PdfContentByte.ALIGN_LEFT,  </span><br><span class="line">                           <span class="string">&quot;F-Left&quot;</span>,  </span><br><span class="line">                           document.left(), y, <span class="number">0</span>);  </span><br><span class="line">        <span class="comment">//中  </span></span><br><span class="line">        cb.showTextAligned(PdfContentByte.ALIGN_CENTER,  </span><br><span class="line">                            writer.getPageNumber()+<span class="string">&quot; page&quot;</span>,  </span><br><span class="line">                           (document.right() + document.left())/<span class="number">2</span>,  </span><br><span class="line">                           y, <span class="number">0</span>);  </span><br><span class="line">        <span class="comment">//右  </span></span><br><span class="line">        cb.showTextAligned(PdfContentByte.ALIGN_RIGHT,  </span><br><span class="line">                           <span class="string">&quot;F-Right&quot;</span>,  </span><br><span class="line">                           document.right(), y, <span class="number">0</span>);  </span><br><span class="line">  </span><br><span class="line">        cb.endText();  </span><br><span class="line">          </span><br><span class="line">        cb.restoreState();  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;);  </span><br><span class="line">  </span><br><span class="line">doc.open();  </span><br><span class="line">doc.add(<span class="keyword">new</span> Paragraph(<span class="string">&quot;1 page&quot;</span>));          </span><br><span class="line">doc.newPage();  </span><br><span class="line">doc.add(<span class="keyword">new</span> Paragraph(<span class="string">&quot;2 page&quot;</span>));          </span><br><span class="line">doc.newPage();  </span><br><span class="line">doc.add(<span class="keyword">new</span> Paragraph(<span class="string">&quot;3 page&quot;</span>));          </span><br><span class="line">doc.newPage();  </span><br><span class="line">doc.add(<span class="keyword">new</span> Paragraph(<span class="string">&quot;4 page&quot;</span>));</span><br></pre></td></tr></table></div></figure>


        <h4 id="左右文字"   >
          <a href="#左右文字" class="heading-link"><i class="fas fa-link"></i></a><a href="#左右文字" class="headerlink" title="左右文字"></a>左右文字</h4>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">PdfWriter writer = PdfWriter.getInstance(document, out);  </span><br><span class="line">  </span><br><span class="line">document.open();  </span><br><span class="line">  </span><br><span class="line">PdfContentByte canvas = writer.getDirectContent();  </span><br><span class="line">  </span><br><span class="line">Phrase phrase1 = <span class="keyword">new</span> Phrase(<span class="string">&quot;This is a test!left&quot;</span>);  </span><br><span class="line">Phrase phrase2 = <span class="keyword">new</span> Phrase(<span class="string">&quot;This is a test!right&quot;</span>);  </span><br><span class="line">Phrase phrase3 = <span class="keyword">new</span> Phrase(<span class="string">&quot;This is a test!center&quot;</span>);  </span><br><span class="line">ColumnText.showTextAligned(canvas, Element.ALIGN_LEFT, phrase1, <span class="number">10</span>, <span class="number">500</span>, <span class="number">0</span>);  </span><br><span class="line">ColumnText.showTextAligned(canvas, Element.ALIGN_RIGHT, phrase2, <span class="number">10</span>, <span class="number">536</span>, <span class="number">0</span>);  </span><br><span class="line">ColumnText.showTextAligned(canvas, Element.ALIGN_CENTER, phrase3, <span class="number">10</span>, <span class="number">572</span>, <span class="number">0</span>);</span><br></pre></td></tr></table></div></figure>


        <h4 id="分割PDF"   >
          <a href="#分割PDF" class="heading-link"><i class="fas fa-link"></i></a><a href="#分割PDF" class="headerlink" title="分割PDF"></a>分割PDF</h4>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">FileOutputStream out = <span class="keyword">new</span> FileOutputStream(FILE_DIR + <span class="string">&quot;splitPDF.pdf&quot;</span>);  </span><br><span class="line">  </span><br><span class="line">Document document = <span class="keyword">new</span> Document();  </span><br><span class="line">  </span><br><span class="line">PdfWriter.getInstance(document, out);  </span><br><span class="line">  </span><br><span class="line">document.open();  </span><br><span class="line">document.add(<span class="keyword">new</span> Paragraph(<span class="string">&quot;1 page&quot;</span>));  </span><br><span class="line">  </span><br><span class="line">document.newPage();  </span><br><span class="line">document.add(<span class="keyword">new</span> Paragraph(<span class="string">&quot;2 page&quot;</span>));  </span><br><span class="line">  </span><br><span class="line">document.newPage();  </span><br><span class="line">document.add(<span class="keyword">new</span> Paragraph(<span class="string">&quot;3 page&quot;</span>));  </span><br><span class="line">  </span><br><span class="line">document.newPage();  </span><br><span class="line">document.add(<span class="keyword">new</span> Paragraph(<span class="string">&quot;4 page&quot;</span>));  </span><br><span class="line">  </span><br><span class="line">document.close();  </span><br><span class="line">  </span><br><span class="line">PdfReader reader = <span class="keyword">new</span> PdfReader(FILE_DIR + <span class="string">&quot;splitPDF.pdf&quot;</span>);  </span><br><span class="line">  </span><br><span class="line">Document dd = <span class="keyword">new</span> Document();  </span><br><span class="line">PdfWriter writer = PdfWriter.getInstance(dd, <span class="keyword">new</span> FileOutputStream(FILE_DIR + <span class="string">&quot;splitPDF1.pdf&quot;</span>));  </span><br><span class="line">dd.open();  </span><br><span class="line">PdfContentByte cb = writer.getDirectContent();  </span><br><span class="line">dd.newPage();  </span><br><span class="line">cb.addTemplate(writer.getImportedPage(reader, <span class="number">1</span>), <span class="number">0</span>, <span class="number">0</span>);  </span><br><span class="line">dd.newPage();  </span><br><span class="line">cb.addTemplate(writer.getImportedPage(reader, <span class="number">2</span>), <span class="number">0</span>, <span class="number">0</span>);  </span><br><span class="line">dd.close();  </span><br><span class="line">writer.close();  </span><br><span class="line">  </span><br><span class="line">Document dd2 = <span class="keyword">new</span> Document();  </span><br><span class="line">PdfWriter writer2 = PdfWriter.getInstance(dd2, <span class="keyword">new</span> FileOutputStream(FILE_DIR + <span class="string">&quot;splitPDF2.pdf&quot;</span>));  </span><br><span class="line">dd2.open();  </span><br><span class="line">PdfContentByte cb2 = writer2.getDirectContent();  </span><br><span class="line">dd2.newPage();  </span><br><span class="line">cb2.addTemplate(writer2.getImportedPage(reader, <span class="number">3</span>), <span class="number">0</span>, <span class="number">0</span>);  </span><br><span class="line">dd2.newPage();  </span><br><span class="line">cb2.addTemplate(writer2.getImportedPage(reader, <span class="number">4</span>), <span class="number">0</span>, <span class="number">0</span>);  </span><br><span class="line">dd2.close();  </span><br><span class="line">writer2.close();</span><br></pre></td></tr></table></div></figure>


        <h4 id="合并PDF"   >
          <a href="#合并PDF" class="heading-link"><i class="fas fa-link"></i></a><a href="#合并PDF" class="headerlink" title="合并PDF"></a>合并PDF</h4>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">PdfReader reader1 = <span class="keyword">new</span> PdfReader(FILE_DIR + <span class="string">&quot;splitPDF1.pdf&quot;</span>);  </span><br><span class="line">PdfReader reader2 = <span class="keyword">new</span> PdfReader(FILE_DIR + <span class="string">&quot;splitPDF2.pdf&quot;</span>);  </span><br><span class="line">  </span><br><span class="line">FileOutputStream out = <span class="keyword">new</span> FileOutputStream(FILE_DIR + <span class="string">&quot;mergePDF.pdf&quot;</span>);  </span><br><span class="line">  </span><br><span class="line">Document document = <span class="keyword">new</span> Document();  </span><br><span class="line">PdfWriter writer = PdfWriter.getInstance(document, out);  </span><br><span class="line">  </span><br><span class="line">document.open();  </span><br><span class="line">PdfContentByte cb = writer.getDirectContent();  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">int</span> totalPages = <span class="number">0</span>;  </span><br><span class="line">totalPages += reader1.getNumberOfPages();  </span><br><span class="line">totalPages += reader2.getNumberOfPages();  </span><br><span class="line">  </span><br><span class="line">java.util.List&lt;PdfReader&gt; readers = <span class="keyword">new</span> ArrayList&lt;PdfReader&gt;();  </span><br><span class="line">readers.add(reader1);  </span><br><span class="line">readers.add(reader2);  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">int</span> pageOfCurrentReaderPDF = <span class="number">0</span>;  </span><br><span class="line">Iterator&lt;PdfReader&gt; iteratorPDFReader = readers.iterator();  </span><br><span class="line">  </span><br><span class="line"><span class="comment">// Loop through the PDF files and add to the output.  </span></span><br><span class="line"><span class="keyword">while</span> (iteratorPDFReader.hasNext()) &#123;  </span><br><span class="line">    PdfReader pdfReader = iteratorPDFReader.next();  </span><br><span class="line">  </span><br><span class="line">    <span class="comment">// Create a new page in the target for each source page.  </span></span><br><span class="line">    <span class="keyword">while</span> (pageOfCurrentReaderPDF &lt; pdfReader.getNumberOfPages()) &#123;  </span><br><span class="line">        document.newPage();  </span><br><span class="line">        pageOfCurrentReaderPDF++;  </span><br><span class="line">        PdfImportedPage page = writer.getImportedPage(pdfReader, pageOfCurrentReaderPDF);  </span><br><span class="line">        cb.addTemplate(page, <span class="number">0</span>, <span class="number">0</span>);  </span><br><span class="line">    &#125;  </span><br><span class="line">    pageOfCurrentReaderPDF = <span class="number">0</span>;  </span><br><span class="line">&#125;  </span><br><span class="line">out.flush();  </span><br><span class="line">document.close();  </span><br><span class="line">out.close();</span><br></pre></td></tr></table></div></figure>


        <h4 id="插入一个Table"   >
          <a href="#插入一个Table" class="heading-link"><i class="fas fa-link"></i></a><a href="#插入一个Table" class="headerlink" title="插入一个Table"></a>插入一个Table</h4>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">PdfPTable table = <span class="keyword">new</span> PdfPTable(<span class="number">3</span>);  </span><br><span class="line">PdfPCell cell;  </span><br><span class="line">cell = <span class="keyword">new</span> PdfPCell(<span class="keyword">new</span> Phrase(<span class="string">&quot;Cell with colspan 3&quot;</span>));  </span><br><span class="line">cell.setColspan(<span class="number">3</span>);  </span><br><span class="line">table.addCell(cell);  </span><br><span class="line">cell = <span class="keyword">new</span> PdfPCell(<span class="keyword">new</span> Phrase(<span class="string">&quot;Cell with rowspan 2&quot;</span>));  </span><br><span class="line">cell.setRowspan(<span class="number">2</span>);  </span><br><span class="line">table.addCell(cell);  </span><br><span class="line">table.addCell(<span class="string">&quot;row 1; cell 1&quot;</span>);  </span><br><span class="line">table.addCell(<span class="string">&quot;row 1; cell 2&quot;</span>);  </span><br><span class="line">table.addCell(<span class="string">&quot;row 2; cell 1&quot;</span>);  </span><br><span class="line">table.addCell(<span class="string">&quot;row 2; cell 2&quot;</span>);  </span><br><span class="line">  </span><br><span class="line">document.add(table);</span><br></pre></td></tr></table></div></figure>


        <h4 id="表格嵌套"   >
          <a href="#表格嵌套" class="heading-link"><i class="fas fa-link"></i></a><a href="#表格嵌套" class="headerlink" title="表格嵌套"></a>表格嵌套</h4>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">PdfPTable table = <span class="keyword">new</span> PdfPTable(<span class="number">4</span>);  </span><br><span class="line">  </span><br><span class="line"><span class="comment">//1行2列  </span></span><br><span class="line">PdfPTable nested1 = <span class="keyword">new</span> PdfPTable(<span class="number">2</span>);  </span><br><span class="line">nested1.addCell(<span class="string">&quot;1.1&quot;</span>);  </span><br><span class="line">nested1.addCell(<span class="string">&quot;1.2&quot;</span>);  </span><br><span class="line">  </span><br><span class="line"><span class="comment">//2行1列  </span></span><br><span class="line">PdfPTable nested2 = <span class="keyword">new</span> PdfPTable(<span class="number">1</span>);  </span><br><span class="line">nested2.addCell(<span class="string">&quot;2.1&quot;</span>);  </span><br><span class="line">nested2.addCell(<span class="string">&quot;2.2&quot;</span>);  </span><br><span class="line">  </span><br><span class="line"><span class="comment">//将表格插入到指定位置  </span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; <span class="number">24</span>; ++k) &#123;  </span><br><span class="line">    <span class="keyword">if</span> (k == <span class="number">1</span>) &#123;  </span><br><span class="line">        table.addCell(nested1);  </span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (k == <span class="number">20</span>) &#123;  </span><br><span class="line">        table.addCell(nested2);  </span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;  </span><br><span class="line">        table.addCell(<span class="string">&quot;cell &quot;</span> + k);  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line">document.add(table);</span><br></pre></td></tr></table></div></figure>


        <h4 id="设置表格宽度"   >
          <a href="#设置表格宽度" class="heading-link"><i class="fas fa-link"></i></a><a href="#设置表格宽度" class="headerlink" title="设置表格宽度"></a>设置表格宽度</h4>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">PdfPTable table = <span class="keyword">new</span> PdfPTable(<span class="number">3</span>);  </span><br><span class="line">PdfPCell cell;  </span><br><span class="line">cell = <span class="keyword">new</span> PdfPCell(<span class="keyword">new</span> Phrase(<span class="string">&quot;Cell with colspan 3&quot;</span>));  </span><br><span class="line">cell.setColspan(<span class="number">3</span>);  </span><br><span class="line">table.addCell(cell);  </span><br><span class="line">cell = <span class="keyword">new</span> PdfPCell(<span class="keyword">new</span> Phrase(<span class="string">&quot;Cell with rowspan 2&quot;</span>));  </span><br><span class="line">cell.setRowspan(<span class="number">2</span>);  </span><br><span class="line">table.addCell(cell);  </span><br><span class="line">table.addCell(<span class="string">&quot;row 1; cell 1&quot;</span>);  </span><br><span class="line">table.addCell(<span class="string">&quot;row 1; cell 2&quot;</span>);  </span><br><span class="line">table.addCell(<span class="string">&quot;row 2; cell 1&quot;</span>);  </span><br><span class="line">table.addCell(<span class="string">&quot;row 2; cell 2&quot;</span>);  </span><br><span class="line">  </span><br><span class="line"><span class="comment">//100%  </span></span><br><span class="line">table.setWidthPercentage(<span class="number">100</span>);  </span><br><span class="line">document.add(table);          </span><br><span class="line">document.add(<span class="keyword">new</span> Paragraph(<span class="string">&quot;\n\n&quot;</span>));  </span><br><span class="line">  </span><br><span class="line"><span class="comment">//宽度50% 居左  </span></span><br><span class="line">table.setHorizontalAlignment(Element.ALIGN_LEFT);  </span><br><span class="line">document.add(table);  </span><br><span class="line">document.add(<span class="keyword">new</span> Paragraph(<span class="string">&quot;\n\n&quot;</span>));  </span><br><span class="line">  </span><br><span class="line"><span class="comment">//宽度50% 居中  </span></span><br><span class="line">table.setHorizontalAlignment(Element.ALIGN_CENTER);  </span><br><span class="line">document.add(table);  </span><br><span class="line">document.add(<span class="keyword">new</span> Paragraph(<span class="string">&quot;\n\n&quot;</span>));  </span><br><span class="line">  </span><br><span class="line"><span class="comment">//宽度50% 居右  </span></span><br><span class="line">table.setWidthPercentage(<span class="number">50</span>);  </span><br><span class="line">table.setHorizontalAlignment(Element.ALIGN_RIGHT);  </span><br><span class="line">document.add(table);  </span><br><span class="line">document.add(<span class="keyword">new</span> Paragraph(<span class="string">&quot;\n\n&quot;</span>));  </span><br><span class="line">  </span><br><span class="line"><span class="comment">//固定宽度  </span></span><br><span class="line">table.setTotalWidth(<span class="number">300</span>);  </span><br><span class="line">table.setLockedWidth(<span class="keyword">true</span>);  </span><br><span class="line">document.add(table);</span><br></pre></td></tr></table></div></figure>


        <h4 id="设置表格前后间隔"   >
          <a href="#设置表格前后间隔" class="heading-link"><i class="fas fa-link"></i></a><a href="#设置表格前后间隔" class="headerlink" title="设置表格前后间隔"></a>设置表格前后间隔</h4>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">PdfPTable table = <span class="keyword">new</span> PdfPTable(<span class="number">3</span>);  </span><br><span class="line">PdfPCell cell = <span class="keyword">new</span> PdfPCell(<span class="keyword">new</span> Paragraph(<span class="string">&quot;合并3个单元格&quot;</span>,fontZH));  </span><br><span class="line">cell.setColspan(<span class="number">3</span>);  </span><br><span class="line">table.addCell(cell);  </span><br><span class="line">table.addCell(<span class="string">&quot;1.1&quot;</span>);  </span><br><span class="line">table.addCell(<span class="string">&quot;2.1&quot;</span>);  </span><br><span class="line">table.addCell(<span class="string">&quot;3.1&quot;</span>);  </span><br><span class="line">table.addCell(<span class="string">&quot;1.2&quot;</span>);  </span><br><span class="line">table.addCell(<span class="string">&quot;2.2&quot;</span>);  </span><br><span class="line">table.addCell(<span class="string">&quot;3.2&quot;</span>);  </span><br><span class="line">  </span><br><span class="line">cell = <span class="keyword">new</span> PdfPCell(<span class="keyword">new</span> Paragraph(<span class="string">&quot;红色边框&quot;</span>,fontZH));  </span><br><span class="line">cell.setBorderColor(<span class="keyword">new</span> BaseColor(<span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>));  </span><br><span class="line">table.addCell(cell);  </span><br><span class="line">  </span><br><span class="line">cell = <span class="keyword">new</span> PdfPCell(<span class="keyword">new</span> Paragraph(<span class="string">&quot;合并单2个元格&quot;</span>,fontZH));  </span><br><span class="line">cell.setColspan(<span class="number">2</span>);  </span><br><span class="line">cell.setBackgroundColor(<span class="keyword">new</span> BaseColor(<span class="number">0xC0</span>, <span class="number">0xC0</span>, <span class="number">0xC0</span>));  </span><br><span class="line">table.addCell(cell);  </span><br><span class="line">  </span><br><span class="line">table.setWidthPercentage(<span class="number">50</span>);  </span><br><span class="line">  </span><br><span class="line">document.add(<span class="keyword">new</span> Paragraph(<span class="string">&quot;追加2个表格&quot;</span>,fontZH));  </span><br><span class="line">document.add(table);  </span><br><span class="line">document.add(table);  </span><br><span class="line">  </span><br><span class="line">document.newPage();  </span><br><span class="line">document.add(<span class="keyword">new</span> Paragraph(<span class="string">&quot;使用&#x27;SpacingBefore&#x27;和&#x27;setSpacingAfter&#x27;&quot;</span>,fontZH));  </span><br><span class="line">table.setSpacingBefore(<span class="number">15f</span>);  </span><br><span class="line">document.add(table);  </span><br><span class="line">document.add(table);  </span><br><span class="line">document.add(<span class="keyword">new</span> Paragraph(<span class="string">&quot;这里没有间隔&quot;</span>,fontZH));  </span><br><span class="line">table.setSpacingAfter(<span class="number">15f</span>);</span><br></pre></td></tr></table></div></figure>


        <h4 id="设置单元格宽度"   >
          <a href="#设置单元格宽度" class="heading-link"><i class="fas fa-link"></i></a><a href="#设置单元格宽度" class="headerlink" title="设置单元格宽度"></a>设置单元格宽度</h4>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//按比例设置单元格宽度  </span></span><br><span class="line"><span class="keyword">float</span>[] widths = &#123;<span class="number">0.1f</span>, <span class="number">0.1f</span>, <span class="number">0.05f</span>, <span class="number">0.75f</span>&#125;;  </span><br><span class="line">PdfPTable table = <span class="keyword">new</span> PdfPTable(widths);  </span><br><span class="line">table.addCell(<span class="string">&quot;10%&quot;</span>);  </span><br><span class="line">table.addCell(<span class="string">&quot;10%&quot;</span>);  </span><br><span class="line">table.addCell(<span class="string">&quot;5%&quot;</span>);  </span><br><span class="line">table.addCell(<span class="string">&quot;75%&quot;</span>);  </span><br><span class="line">table.addCell(<span class="string">&quot;aa&quot;</span>);  </span><br><span class="line">table.addCell(<span class="string">&quot;aa&quot;</span>);  </span><br><span class="line">table.addCell(<span class="string">&quot;a&quot;</span>);  </span><br><span class="line">table.addCell(<span class="string">&quot;aaaaaaaaaaaaaaa&quot;</span>);  </span><br><span class="line">table.addCell(<span class="string">&quot;bb&quot;</span>);  </span><br><span class="line">table.addCell(<span class="string">&quot;bb&quot;</span>);  </span><br><span class="line">table.addCell(<span class="string">&quot;b&quot;</span>);  </span><br><span class="line">table.addCell(<span class="string">&quot;bbbbbbbbbbbbbbb&quot;</span>);  </span><br><span class="line">table.addCell(<span class="string">&quot;cc&quot;</span>);  </span><br><span class="line">table.addCell(<span class="string">&quot;cc&quot;</span>);  </span><br><span class="line">table.addCell(<span class="string">&quot;c&quot;</span>);  </span><br><span class="line">table.addCell(<span class="string">&quot;ccccccccccccccc&quot;</span>);  </span><br><span class="line">document.add(table);  </span><br><span class="line">document.add(<span class="keyword">new</span> Paragraph(<span class="string">&quot;\n\n&quot;</span>));  </span><br><span class="line">  </span><br><span class="line"><span class="comment">//调整比例  </span></span><br><span class="line">widths[<span class="number">0</span>] = <span class="number">20f</span>;  </span><br><span class="line">widths[<span class="number">1</span>] = <span class="number">20f</span>;  </span><br><span class="line">widths[<span class="number">2</span>] = <span class="number">10f</span>;  </span><br><span class="line">widths[<span class="number">3</span>] = <span class="number">50f</span>;  </span><br><span class="line">table.setWidths(widths);  </span><br><span class="line">document.add(table);  </span><br><span class="line">  </span><br><span class="line"><span class="comment">//按绝对值设置单元格宽度  </span></span><br><span class="line">widths[<span class="number">0</span>] = <span class="number">40f</span>;  </span><br><span class="line">widths[<span class="number">1</span>] = <span class="number">40f</span>;  </span><br><span class="line">widths[<span class="number">2</span>] = <span class="number">20f</span>;  </span><br><span class="line">widths[<span class="number">3</span>] = <span class="number">300f</span>;  </span><br><span class="line">Rectangle r = <span class="keyword">new</span> Rectangle(PageSize.A4.getRight(<span class="number">72</span>), PageSize.A4.getTop(<span class="number">72</span>));  </span><br><span class="line">table.setWidthPercentage(widths, r);  </span><br><span class="line">document.add(<span class="keyword">new</span> Paragraph(<span class="string">&quot;\n\n&quot;</span>));  </span><br><span class="line">document.add(table);</span><br></pre></td></tr></table></div></figure>


        <h4 id="设置单元格高度"   >
          <a href="#设置单元格高度" class="heading-link"><i class="fas fa-link"></i></a><a href="#设置单元格高度" class="headerlink" title="设置单元格高度"></a>设置单元格高度</h4>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">PdfPTable table = <span class="keyword">new</span> PdfPTable(<span class="number">2</span>);  </span><br><span class="line">  </span><br><span class="line">PdfPCell cell;  </span><br><span class="line">  </span><br><span class="line"><span class="comment">//折行  </span></span><br><span class="line">table.addCell(<span class="keyword">new</span> PdfPCell(<span class="keyword">new</span> Paragraph(<span class="string">&quot;折行&quot;</span>, fontZH)));  </span><br><span class="line">cell = <span class="keyword">new</span> PdfPCell(<span class="keyword">new</span> Paragraph(<span class="string">&quot;blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah&quot;</span>));  </span><br><span class="line">cell.setNoWrap(<span class="keyword">false</span>);  </span><br><span class="line">table.addCell(cell);  </span><br><span class="line">  </span><br><span class="line"><span class="comment">//不折行  </span></span><br><span class="line">table.addCell(<span class="keyword">new</span> PdfPCell(<span class="keyword">new</span> Paragraph(<span class="string">&quot;不折行&quot;</span>, fontZH)));  </span><br><span class="line">cell.setNoWrap(<span class="keyword">true</span>);  </span><br><span class="line">table.addCell(cell);  </span><br><span class="line">  </span><br><span class="line"><span class="comment">//设置高度  </span></span><br><span class="line">table.addCell(<span class="keyword">new</span> PdfPCell(<span class="keyword">new</span> Paragraph(<span class="string">&quot;任意高度&quot;</span>,fontZH)));  </span><br><span class="line">cell = <span class="keyword">new</span> PdfPCell(<span class="keyword">new</span> Paragraph(<span class="string">&quot;1. blah blah\n2. blah blah blah\n3. blah blah\n4. blah blah blah\n5. blah blah\n6. blah blah blah\n7. blah blah\n8. blah blah blah&quot;</span>));  </span><br><span class="line">table.addCell(cell);  </span><br><span class="line">  </span><br><span class="line"><span class="comment">//固定高度  </span></span><br><span class="line">table.addCell(<span class="keyword">new</span> PdfPCell(<span class="keyword">new</span> Paragraph(<span class="string">&quot;固定高度&quot;</span>,fontZH)));  </span><br><span class="line">cell.setFixedHeight(<span class="number">50f</span>);  </span><br><span class="line">table.addCell(cell);  </span><br><span class="line">  </span><br><span class="line"><span class="comment">//最小高度  </span></span><br><span class="line">table.addCell(<span class="keyword">new</span> PdfPCell(<span class="keyword">new</span> Paragraph(<span class="string">&quot;最小高度&quot;</span>,fontZH)));  </span><br><span class="line">cell = <span class="keyword">new</span> PdfPCell(<span class="keyword">new</span> Paragraph(<span class="string">&quot;最小高度：50&quot;</span>,fontZH));  </span><br><span class="line">cell.setMinimumHeight(<span class="number">50f</span>);  </span><br><span class="line">table.addCell(cell);  </span><br><span class="line">  </span><br><span class="line"><span class="comment">//最后一行拉长到page底部  </span></span><br><span class="line">table.setExtendLastRow(<span class="keyword">true</span>);  </span><br><span class="line">table.addCell(<span class="keyword">new</span> PdfPCell(<span class="keyword">new</span> Paragraph(<span class="string">&quot;拉长最后一行&quot;</span>,fontZH)));  </span><br><span class="line">cell = <span class="keyword">new</span> PdfPCell(<span class="keyword">new</span> Paragraph(<span class="string">&quot;最后一行拉长到page底部&quot;</span>,fontZH));  </span><br><span class="line">table.addCell(cell);  </span><br><span class="line">  </span><br><span class="line">document.add(table);</span><br></pre></td></tr></table></div></figure>


        <h4 id="设置单元格颜色"   >
          <a href="#设置单元格颜色" class="heading-link"><i class="fas fa-link"></i></a><a href="#设置单元格颜色" class="headerlink" title="设置单元格颜色"></a>设置单元格颜色</h4>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">PdfPTable table = <span class="keyword">new</span> PdfPTable(<span class="number">4</span>);  </span><br><span class="line">PdfPCell cell;  </span><br><span class="line">cell = <span class="keyword">new</span> PdfPCell(<span class="keyword">new</span> Paragraph(<span class="string">&quot;颜色测试&quot;</span>,fontZH));  </span><br><span class="line">table.addCell(cell);  </span><br><span class="line">  </span><br><span class="line"><span class="comment">//红色背景，无边框  </span></span><br><span class="line">cell = <span class="keyword">new</span> PdfPCell(<span class="keyword">new</span> Paragraph(<span class="string">&quot;红色背景，无边框&quot;</span>,fontZH));  </span><br><span class="line">cell.setBorder(Rectangle.NO_BORDER);  </span><br><span class="line">cell.setBackgroundColor(BaseColor.RED);  </span><br><span class="line">table.addCell(cell);  </span><br><span class="line">  </span><br><span class="line"><span class="comment">//绿色背景，下边框  </span></span><br><span class="line">cell = <span class="keyword">new</span> PdfPCell(<span class="keyword">new</span> Paragraph(<span class="string">&quot;绿色背景，下边框&quot;</span>,fontZH));  </span><br><span class="line">cell.setBorder(Rectangle.BOTTOM);  </span><br><span class="line">cell.setBorderColorBottom(BaseColor.MAGENTA);  </span><br><span class="line">cell.setBorderWidthBottom(<span class="number">5f</span>);  </span><br><span class="line">cell.setBackgroundColor(BaseColor.GREEN);  </span><br><span class="line">table.addCell(cell);  </span><br><span class="line">  </span><br><span class="line"><span class="comment">//蓝色背景，上边框  </span></span><br><span class="line">cell = <span class="keyword">new</span> PdfPCell(<span class="keyword">new</span> Paragraph(<span class="string">&quot;蓝色背景，上边框&quot;</span>,fontZH));  </span><br><span class="line">cell.setBorder(Rectangle.TOP);  </span><br><span class="line">cell.setUseBorderPadding(<span class="keyword">true</span>);  </span><br><span class="line">cell.setBorderWidthTop(<span class="number">5f</span>);  </span><br><span class="line">cell.setBorderColorTop(BaseColor.CYAN);  </span><br><span class="line">cell.setBackgroundColor(BaseColor.BLUE);  </span><br><span class="line">table.addCell(cell);  </span><br><span class="line">  </span><br><span class="line">cell = <span class="keyword">new</span> PdfPCell(<span class="keyword">new</span> Paragraph(<span class="string">&quot;背景灰色度&quot;</span>,fontZH));  </span><br><span class="line">table.addCell(cell);  </span><br><span class="line">cell = <span class="keyword">new</span> PdfPCell(<span class="keyword">new</span> Paragraph(<span class="string">&quot;0.25&quot;</span>));  </span><br><span class="line">cell.setBorder(Rectangle.NO_BORDER);  </span><br><span class="line">cell.setGrayFill(<span class="number">0.25f</span>);  </span><br><span class="line">table.addCell(cell);  </span><br><span class="line">cell = <span class="keyword">new</span> PdfPCell(<span class="keyword">new</span> Paragraph(<span class="string">&quot;0.5&quot;</span>));  </span><br><span class="line">cell.setBorder(Rectangle.NO_BORDER);  </span><br><span class="line">cell.setGrayFill(<span class="number">0.5f</span>);  </span><br><span class="line">table.addCell(cell);  </span><br><span class="line">cell = <span class="keyword">new</span> PdfPCell(<span class="keyword">new</span> Paragraph(<span class="string">&quot;0.75&quot;</span>));  </span><br><span class="line">cell.setBorder(Rectangle.NO_BORDER);  </span><br><span class="line">cell.setGrayFill(<span class="number">0.75f</span>);  </span><br><span class="line">table.addCell(cell);  </span><br><span class="line">  </span><br><span class="line">document.add(table);</span><br></pre></td></tr></table></div></figure>


        <h4 id="设置表头"   >
          <a href="#设置表头" class="heading-link"><i class="fas fa-link"></i></a><a href="#设置表头" class="headerlink" title="设置表头"></a>设置表头</h4>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">String[] bogusData = &#123; <span class="string">&quot;M0065920&quot;</span>, <span class="string">&quot;SL&quot;</span>, <span class="string">&quot;FR86000P&quot;</span>, <span class="string">&quot;PCGOLD&quot;</span>,  </span><br><span class="line">        <span class="string">&quot;119000&quot;</span>, <span class="string">&quot;96 06&quot;</span>, <span class="string">&quot;2001-08-13&quot;</span>, <span class="string">&quot;4350&quot;</span>, <span class="string">&quot;6011648299&quot;</span>,  </span><br><span class="line">        <span class="string">&quot;FLFLMTGP&quot;</span>, <span class="string">&quot;153&quot;</span>, <span class="string">&quot;119000.00&quot;</span> &#125;;  </span><br><span class="line"><span class="keyword">int</span> NumColumns = <span class="number">12</span>;  </span><br><span class="line"><span class="comment">// 12  </span></span><br><span class="line">PdfPTable datatable = <span class="keyword">new</span> PdfPTable(NumColumns);  </span><br><span class="line"><span class="keyword">int</span> headerwidths[] = &#123; <span class="number">9</span>, <span class="number">4</span>, <span class="number">8</span>, <span class="number">10</span>, <span class="number">8</span>, <span class="number">11</span>, <span class="number">9</span>, <span class="number">7</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">4</span>, <span class="number">10</span> &#125;; <span class="comment">// percentage  </span></span><br><span class="line">datatable.setWidths(headerwidths);  </span><br><span class="line">datatable.setWidthPercentage(<span class="number">100</span>);  </span><br><span class="line">datatable.getDefaultCell().setPadding(<span class="number">3</span>);  </span><br><span class="line">datatable.getDefaultCell().setBorderWidth(<span class="number">2</span>);  </span><br><span class="line">datatable.getDefaultCell().setHorizontalAlignment(Element.ALIGN_CENTER);  </span><br><span class="line">  </span><br><span class="line">datatable.addCell(<span class="string">&quot;Clock #&quot;</span>);  </span><br><span class="line">datatable.addCell(<span class="string">&quot;Trans Type&quot;</span>);  </span><br><span class="line">datatable.addCell(<span class="string">&quot;Cusip&quot;</span>);  </span><br><span class="line">datatable.addCell(<span class="string">&quot;Long Name&quot;</span>);  </span><br><span class="line">datatable.addCell(<span class="string">&quot;Quantity&quot;</span>);  </span><br><span class="line">datatable.addCell(<span class="string">&quot;Fraction Price&quot;</span>);  </span><br><span class="line">datatable.addCell(<span class="string">&quot;Settle Date&quot;</span>);  </span><br><span class="line">datatable.addCell(<span class="string">&quot;Portfolio&quot;</span>);  </span><br><span class="line">datatable.addCell(<span class="string">&quot;ADP Number&quot;</span>);  </span><br><span class="line">datatable.addCell(<span class="string">&quot;Account ID&quot;</span>);  </span><br><span class="line">datatable.addCell(<span class="string">&quot;Reg Rep ID&quot;</span>);  </span><br><span class="line">datatable.addCell(<span class="string">&quot;Amt To Go &quot;</span>);  </span><br><span class="line">  </span><br><span class="line">datatable.setHeaderRows(<span class="number">1</span>);  </span><br><span class="line">  </span><br><span class="line"><span class="comment">//边框  </span></span><br><span class="line">datatable.getDefaultCell().setBorderWidth(<span class="number">1</span>);  </span><br><span class="line">  </span><br><span class="line"><span class="comment">//背景色  </span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; <span class="number">1000</span>; i++) &#123;  </span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> x = <span class="number">0</span>; x &lt; NumColumns; x++) &#123;  </span><br><span class="line">        datatable.addCell(bogusData[x]);  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line">document.add(datatable);</span><br></pre></td></tr></table></div></figure>


        <h4 id="设置单元格边框"   >
          <a href="#设置单元格边框" class="heading-link"><i class="fas fa-link"></i></a><a href="#设置单元格边框" class="headerlink" title="设置单元格边框"></a>设置单元格边框</h4>
      <figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//没有边框  </span></span><br><span class="line">PdfPTable table1 = <span class="keyword">new</span> PdfPTable(<span class="number">3</span>);    </span><br><span class="line">table1.getDefaultCell().setBorder(PdfPCell.NO_BORDER);    </span><br><span class="line">table1.addCell(<span class="keyword">new</span> Paragraph(<span class="string">&quot;Cell 1&quot;</span>));   </span><br><span class="line">table1.addCell(<span class="keyword">new</span> Paragraph(<span class="string">&quot;Cell 2&quot;</span>));   </span><br><span class="line">table1.addCell(<span class="keyword">new</span> Paragraph(<span class="string">&quot;Cell 3&quot;</span>));   </span><br><span class="line">document.add(table1);  </span><br><span class="line">  </span><br><span class="line"><span class="comment">//边框粗细颜色  </span></span><br><span class="line">document.newPage();  </span><br><span class="line">Rectangle b1 = <span class="keyword">new</span> Rectangle(<span class="number">0f</span>, <span class="number">0f</span>);  </span><br><span class="line">b1.setBorderWidthLeft(<span class="number">6f</span>);  </span><br><span class="line">b1.setBorderWidthBottom(<span class="number">5f</span>);  </span><br><span class="line">b1.setBorderWidthRight(<span class="number">4f</span>);  </span><br><span class="line">b1.setBorderWidthTop(<span class="number">2f</span>);  </span><br><span class="line">b1.setBorderColorLeft(BaseColor.RED);  </span><br><span class="line">b1.setBorderColorBottom(BaseColor.ORANGE);  </span><br><span class="line">b1.setBorderColorRight(BaseColor.YELLOW);  </span><br><span class="line">b1.setBorderColorTop(BaseColor.GREEN);  </span><br><span class="line">PdfPTable table2 = <span class="keyword">new</span> PdfPTable(<span class="number">1</span>);  </span><br><span class="line">PdfPCell cell =  <span class="keyword">new</span> PdfPCell(<span class="keyword">new</span> Paragraph(<span class="string">&quot;Cell 1&quot;</span>));  </span><br><span class="line">cell.cloneNonPositionParameters(b1);  </span><br><span class="line">table2.addCell(cell);  </span><br><span class="line">document.add(table2);</span><br></pre></td></tr></table></div></figure>

</div><footer class="post-footer"><div class="post-ending ending"><div class="ending__text">------ 本文结束，感谢您的阅读 ------</div></div><div class="post-copyright copyright"><div class="copyright-author"><span class="copyright-author__name">本文作者: </span><span class="copyright-author__value"><a href="http://garfielder.com">Garfield</a></span></div><div class="copyright-link"><span class="copyright-link__name">本文链接: </span><span class="copyright-link__value"><a href="http://garfielder.com/post/2b3e24ae.html">http://garfielder.com/post/2b3e24ae.html</a></span></div><div class="copyright-notice"><span class="copyright-notice__name">版权声明: </span><span class="copyright-notice__value">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en" rel="external nofollow" target="_blank">BY-NC-SA</a> 许可协议。转载请注明出处！</span></div></div><div class="post-tags"><span class="post-tags-item"><span class="post-tags-item__icon"><i class="fas fa-tag"></i></span><a class="post-tags-item__link" href="http://garfielder.com/tags/iText/">iText</a></span><span class="post-tags-item"><span class="post-tags-item__icon"><i class="fas fa-tag"></i></span><a class="post-tags-item__link" href="http://garfielder.com/tags/Java/">Java</a></span></div><nav class="post-paginator paginator"><div class="paginator-prev"><a class="paginator-prev__link" href="/post/da01de8.html"><span class="paginator-prev__icon"><i class="fas fa-angle-left"></i></span><span class="paginator-prev__text">iText之PDF添加页码</span></a></div><div class="paginator-next"><a class="paginator-next__link" href="/post/a5eecd86.html"><span class="paginator-prev__text">Nextcloud 修改数据存储位置</span><span class="paginator-next__icon"><i class="fas fa-angle-right"></i></span></a></div></nav></footer></div></div><div class="comments" id="comments"><div id="valine-container"></div></div></div><div class="sidebar-wrap" id="sidebar-wrap"><aside class="sidebar" id="sidebar"><div class="sidebar-nav"><span class="sidebar-nav-toc current">文章目录</span><span class="sidebar-nav-ov">站点概览</span></div><section class="sidebar-toc"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%8B%E7%BB%8D"><span class="toc-number">1.</span> <span class="toc-text">
          介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B"><span class="toc-number">2.</span> <span class="toc-text">
          入门教程</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%94%9F%E6%88%90%E4%B8%80%E4%B8%AAPDF"><span class="toc-number">2.1.</span> <span class="toc-text">
          生成一个PDF</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A1%B5%E9%9D%A2%E5%A4%A7%E5%B0%8F%E3%80%81%E9%A1%B5%E9%9D%A2%E8%83%8C%E6%99%AF%E8%89%B2%E3%80%81%E9%A1%B5%E8%BE%B9%E7%A9%BA%E7%99%BD%E3%80%81Title%E3%80%81Author%E3%80%81Subject%E3%80%81Keywords"><span class="toc-number">2.2.</span> <span class="toc-text">
          页面大小、页面背景色、页边空白、Title、Author、Subject、Keywords</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AE%E5%AF%86%E7%A0%81"><span class="toc-number">2.3.</span> <span class="toc-text">
          设置密码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B7%BB%E5%8A%A0Page"><span class="toc-number">2.4.</span> <span class="toc-text">
          添加Page</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B7%BB%E5%8A%A0%E6%B0%B4%E5%8D%B0"><span class="toc-number">2.5.</span> <span class="toc-text">
          添加水印</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8F%92%E5%85%A5Chunk%E3%80%81Phrase%E3%80%81Paragraph%E3%80%81List"><span class="toc-number">2.6.</span> <span class="toc-text">
          插入Chunk、Phrase、Paragraph、List</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8F%92%E5%85%A5Anchor%E3%80%81Image%E3%80%81Chapter%E3%80%81Section"><span class="toc-number">2.7.</span> <span class="toc-text">
          插入Anchor、Image、Chapter、Section</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%94%BB%E5%9B%BE"><span class="toc-number">2.8.</span> <span class="toc-text">
          画图</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AE%E6%AE%B5%E8%90%BD"><span class="toc-number">2.9.</span> <span class="toc-text">
          设置段落</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%A0%E9%99%A4Page"><span class="toc-number">2.10.</span> <span class="toc-text">
          删除Page</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8F%92%E5%85%A5Page"><span class="toc-number">2.11.</span> <span class="toc-text">
          插入Page</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8E%92%E5%BA%8FPage"><span class="toc-number">2.12.</span> <span class="toc-text">
          排序Page</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%AE%E5%BD%95"><span class="toc-number">2.13.</span> <span class="toc-text">
          目录</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Header%E3%80%81Footer"><span class="toc-number">2.14.</span> <span class="toc-text">
          Header、Footer</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B7%A6%E5%8F%B3%E6%96%87%E5%AD%97"><span class="toc-number">2.15.</span> <span class="toc-text">
          左右文字</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%86%E5%89%B2PDF"><span class="toc-number">2.16.</span> <span class="toc-text">
          分割PDF</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%90%88%E5%B9%B6PDF"><span class="toc-number">2.17.</span> <span class="toc-text">
          合并PDF</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8F%92%E5%85%A5%E4%B8%80%E4%B8%AATable"><span class="toc-number">2.18.</span> <span class="toc-text">
          插入一个Table</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A1%A8%E6%A0%BC%E5%B5%8C%E5%A5%97"><span class="toc-number">2.19.</span> <span class="toc-text">
          表格嵌套</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AE%E8%A1%A8%E6%A0%BC%E5%AE%BD%E5%BA%A6"><span class="toc-number">2.20.</span> <span class="toc-text">
          设置表格宽度</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AE%E8%A1%A8%E6%A0%BC%E5%89%8D%E5%90%8E%E9%97%B4%E9%9A%94"><span class="toc-number">2.21.</span> <span class="toc-text">
          设置表格前后间隔</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AE%E5%8D%95%E5%85%83%E6%A0%BC%E5%AE%BD%E5%BA%A6"><span class="toc-number">2.22.</span> <span class="toc-text">
          设置单元格宽度</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AE%E5%8D%95%E5%85%83%E6%A0%BC%E9%AB%98%E5%BA%A6"><span class="toc-number">2.23.</span> <span class="toc-text">
          设置单元格高度</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AE%E5%8D%95%E5%85%83%E6%A0%BC%E9%A2%9C%E8%89%B2"><span class="toc-number">2.24.</span> <span class="toc-text">
          设置单元格颜色</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AE%E8%A1%A8%E5%A4%B4"><span class="toc-number">2.25.</span> <span class="toc-text">
          设置表头</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AE%E5%8D%95%E5%85%83%E6%A0%BC%E8%BE%B9%E6%A1%86"><span class="toc-number">2.26.</span> <span class="toc-text">
          设置单元格边框</span></a></li></ol></li></ol></section><!-- ov = overview--><section class="sidebar-ov hide"><div class="sidebar-ov-author"><div class="sidebar-ov-author__avatar"><img class="sidebar-ov-author__avatar_img" src="https://i.loli.net/2021/03/09/b1rHUNsg9GdK2S5.jpg" alt="avatar"></div><p class="sidebar-ov-author__text">向上向善</p></div><div class="sidebar-ov-social"><a class="sidebar-ov-social-item" href="https://github.com/GarfieldCCC" target="_blank" rel="noopener" data-popover="Github" data-popover-pos="up"><span class="sidebar-ov-social-item__icon"><i class="fab fa-github"></i></span></a><a class="sidebar-ov-social-item" href="https://www.jianshu.com/u/e8214c6701c6" target="_blank" rel="noopener" data-popover="简书" data-popover-pos="up"><span class="sidebar-ov-social-item__icon">简</span></a><a class="sidebar-ov-social-item" href="https://segmentfault.com/u/garfield_598ab2e99b0c5" target="_blank" rel="noopener" data-popover="思否" data-popover-pos="up"><span class="sidebar-ov-social-item__icon">sf</span></a><a class="sidebar-ov-social-item" href="https://www.zhihu.com/people/garfield-21-38" target="_blank" rel="noopener" data-popover="知乎" data-popover-pos="up"><span class="sidebar-ov-social-item__icon">知</span></a></div><div class="sidebar-ov-cc"><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en" target="_blank" rel="noopener" data-popover="知识共享许可协议" data-popover-pos="up"><img src="/images/cc-by-nc-sa.svg"></a></div></section><div class="sidebar-reading"><div class="sidebar-reading-info"><span class="sidebar-reading-info__text">你已阅读了 </span><span class="sidebar-reading-info__num">0</span><span class="sidebar-reading-info__perc">%</span></div><div class="sidebar-reading-line"></div></div></aside></div><div class="clearfix"></div></div></main><footer class="footer" id="footer"><div class="footer-inner"><div><span>Copyright © 2022</span><span class="footer__icon"><i class="fas fa-heart"></i></span><span>Garfield</span></div><div><span>由 <a href="http://hexo.io/" title="Hexo" target="_blank" rel="noopener">Hexo</a> 强力驱动</span><span> v5.4.0</span><span class="footer__devider">|</span><span>主题 - <a href="https://github.com/liuyib/hexo-theme-stun/" title="Stun" target="_blank" rel="noopener">Stun</a></span><span> v2.6.2</span></div><div class="busuanzi"><span class="busuanzi-siteuv"><span class="busuanzi-siteuv__icon"><i class="fas fa-user"></i></span><span class="busuanzi-siteuv__info">访问人数</span><span class="busuanzi-siteuv__value" id="busuanzi_value_site_uv"></span></span><span class="busuanzi-sitepv"><span class="busuanzi-siteuv__icon"><i class="fas fa-eye"></i></span><span class="busuanzi-siteuv__info">浏览总量</span><span class="busuanzi-siteuv__value" id="busuanzi_value_site_pv"></span></span></div></div></footer><div class="loading-bar" id="loading-bar"><div class="loading-bar__progress"></div></div><div class="back2top" id="back2top"><span class="back2top__icon"><i class="fas fa-rocket"></i></span></div></div><div class="search-mask"></div><div class="search-popup"><span class="search-close"></span><div class="search-input"><input placeholder="搜索文章（支持多关键词，请用空格分隔）"></div><div class="search-results"></div></div><script src="https://cdn.jsdelivr.net/npm/jquery@v3.4.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.ui.min.js"></script><script src="https://cdn.jsdelivr.net/npm/ribbon.js@latest/dist/ribbon.min.js" size="120" alpha="0.6" zIndex="-1"></script><script src="https://cdn.jsdelivr.net/npm/canvas-nest.js@1.0.1/dist/canvas-nest.min.js" color="0,0,0" opacity="0.6" count="99" zIndex="-1"></script><script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lazyload@2.0.0-rc.2/lazyload.min.js"></script><script>function initSearch() {
  var isXML = true;
  var search_path = 'search.json';

  if (!search_path) {
    search_path = 'search.xml';
  } else if (/json$/i.test(search_path)) {
    isXML = false;
  }

  var path = '/' + search_path;
  $.ajax({
    url: path,
    dataType: isXML ? 'xml' : 'json',
    async: true,
    success: function (res) {
      var datas = isXML ? $('entry', res).map(function () {
        // 将 XML 转为 JSON
        return {
          title: $('title', this).text(),
          content: $('content', this).text(),
          url: $('url', this).text()
        };
      }).get() : res;
      var $input = $('.search-input input');
      var $result = $('.search-results');
      // 搜索对象（标题、内容）的权重，影响显示顺序
      var WEIGHT = { title: 100, content: 1 };
      var searchPost = function () {
        var searchText = $input.val().toLowerCase().trim();
        // 根据空白字符分隔关键字
        var keywords = searchText.split(/[\s]+/);
        // 搜索结果
        var matchPosts = [];

        // 有多个关键字时，将原文字整个保存下来
        if (keywords.length > 1) {
          keywords.push(searchText);
        }
        // 防止未输入字符时搜索
        if (searchText.length > 0) {
          datas.forEach(function (data) {
            var isMatch  = false;
            // 没有标题的文章使用预设的 i18n 变量代替
            var title = (data.title && data.title.trim()) || '[ 文章无标题 ]';
            var titleLower = title && title.toLowerCase();
            // 删除 HTML 标签 和 所有空白字符
            var content = data.content && data.content.replace(/<[^>]+>/g, '');
            var contentLower = content && content.toLowerCase();
            // 删除重复的 /
            var postURL = data.url && decodeURI(data.url).replace(/\/{2,}/g, '/');
            // 标题中匹配到的关键词
            var titleHitSlice = [];
            // 内容中匹配到的关键词
            var contentHitSlice = [];

            keywords.forEach(function (keyword) {
              /**
              * 获取匹配的关键词的索引
              * @param {String} keyword 要匹配的关键字
              * @param {String} text 原文字
              * @param {Boolean} caseSensitive 是否区分大小写
              * @param {Number} weight 匹配对象的权重。权重大的优先显示
              * @return {Array}
              */
              function getIndexByword (word, text, caseSensitive, weight) {
                if (!word || !text) {
                  return [];
                };

                var startIndex = 0; // 每次匹配的开始索引
                var index = -1;     // 匹配到的索引值
                var result = [];    // 匹配结果

                if (!caseSensitive) {
                  word = word.toLowerCase();
                  text = text.toLowerCase();
                }

                while((index = text.indexOf(word, startIndex)) !== -1) {
                  var hasMatch = false;
                  // 索引位置相同的关键词，保留长度较长的
                  titleHitSlice.forEach(function (hit) {
                    if (hit.index === index && hit.word.length < word.length) {
                      hit.word = word;
                      hasMatch = true;
                    }
                  });
                  startIndex = index + word.length;
                  !hasMatch && result.push({ index: index, word: word, weight: weight });
                }
                return result;
              }
              titleHitSlice = titleHitSlice.concat(getIndexByword(keyword, titleLower, false, WEIGHT.title));
              contentHitSlice = contentHitSlice.concat(getIndexByword(keyword, contentLower, false, WEIGHT.content));
            });

            var hitTitle = titleHitSlice.length;
            var hitContent = contentHitSlice.length;

            if (hitTitle > 0 || hitContent > 0) {
              isMatch = true;
            }
            if (isMatch) {
              ;[titleHitSlice, contentHitSlice].forEach(function (hit) {
                // 按照匹配文字的索引的递增顺序排序
                hit.sort(function (left, right) {
                  return left.index - right.index;
                });
              });
              /**
              * 给文本中匹配到的关键词添加标记，从而进行高亮显示
              * @param {String} text 原文本
              * @param {Array} hitSlice 匹配项的索引信息
              * @param {Number} start 开始索引
              * @param {Number} end 结束索引
              * @return {String}
              */
              function highlightKeyword (text, hitSlice, start, end) {
                if (!text || !hitSlice || !hitSlice.length) {
                  return;
                }

                var result = '';
                var startIndex = start;
                var endIndex = end;
                hitSlice.forEach(function (hit) {
                  if (hit.index < startIndex) {
                    return;
                  }

                  var hitWordEnd = hit.index + hit.word.length;
                  result += text.slice(startIndex, hit.index);
                  result += '<b>' + text.slice(hit.index, hitWordEnd) + '</b>';
                  startIndex = hitWordEnd;
                });
                result += text.slice(startIndex, endIndex);
                return result;
              }

              var postData = {};
              // 文章总的搜索权重
              var postWeight = titleHitSlice.length * WEIGHT.title + contentHitSlice.length * WEIGHT.content;
              // 标记匹配关键词后的标题
              var postTitle = highlightKeyword(title, titleHitSlice, 0, title.length) || title;
              // 标记匹配关键词后的内容
              var postContent;
              // 显示内容的长度
              var SHOW_WORD_LENGTH = 200;
              // 命中关键词前的字符显示长度
              var SHOW_WORD_FRONT_LENGTH = 20;
              var SHOW_WORD_END_LENGTH = SHOW_WORD_LENGTH - SHOW_WORD_FRONT_LENGTH;

              // 截取匹配的第一个字符，前后共 200 个字符来显示
              if (contentHitSlice.length > 0) {
                var firstIndex = contentHitSlice[0].index;
                var start = firstIndex > SHOW_WORD_FRONT_LENGTH ? firstIndex - SHOW_WORD_FRONT_LENGTH : 0;
                var end = firstIndex + SHOW_WORD_END_LENGTH;
                postContent = highlightKeyword(content, contentHitSlice, start, end);
              } else { // 未匹配到内容，直接截取前 200 个字符来显示
                postContent = content.slice(0, SHOW_WORD_LENGTH);
              }
              postData.title = postTitle;
              postData.content = postContent;
              postData.url = postURL;
              postData.weight = postWeight;
              matchPosts.push(postData);
            }
          });
        }

        var resultInnerHtml = '';
        if (matchPosts.length) {
          // 按权重递增的顺序排序，使权重大的优先显示
          matchPosts.sort(function (left, right) {
            return right.weight - left.weight;
          });
          resultInnerHtml += '<ul>';
          matchPosts.forEach(function (post) {
            resultInnerHtml += '<li><a class="search-results-title" href="' + post.url + '">';
            resultInnerHtml += post.title;
            resultInnerHtml += '</a><div class="search-results-content">';
            resultInnerHtml += post.content;
            resultInnerHtml += '</div></li>';
          });
          resultInnerHtml += '</ul>';
        } else {
          resultInnerHtml += '<div class="search-results-none"><i class="far fa-meh"></i></div>';
        }
        $result.html(resultInnerHtml);
      };
      $input.on('input', searchPost);
      $input.on('keyup', function (e) {
        if (e.keyCode === Stun.utils.codeToKeyCode('Enter')) {
          searchPost();
        }
      });
    }
  });
}

function closeSearch () {
  $('body').css({ overflow: 'auto' });
  $('.search-popup').css({ display: 'none' });
  $('.search-mask').css({ display: 'none' });
}

window.addEventListener('DOMContentLoaded', function () {
  Stun.utils.pjaxReloadLocalSearch = function () {
    $('.header-nav-search').on('click', function (e) {
      e.stopPropagation();
      $('body').css('overflow', 'hidden');
      $('.search-popup')
        .velocity('stop')
        .velocity('transition.expandIn', {
          duration: 300,
          complete: function () {
            $('.search-popup input').focus();
          }
        });
      $('.search-mask')
        .velocity('stop')
        .velocity('transition.fadeIn', {
          duration: 300
        });

      initSearch();
    });
    $('.search-mask, .search-close').on('click', function () {
      closeSearch();
    });
    $(document).on('keydown', function (e) {
      // Escape <=> 27
      if (e.keyCode === Stun.utils.codeToKeyCode('Escape')) {
        closeSearch();
      }
    });
  };

  Stun.utils.pjaxReloadLocalSearch();
}, false);

function safeOpenUrl(url) {
  var newTab = window.open();
  newTab.opener = null;
  newTab.location = url;
}

function extSearch(engine) {
  var engines = {
    google: 'https://www.google.com/search?q=',
    bing: 'https://cn.bing.com/search?q=',
    baidu: 'https://www.baidu.com/s?ie=UTF-8&wd=',
  };
  var host = window.location.host;
  var query = $('.search-input input').val().toLowerCase().trim();
  var uri = engines[engine] + query + ' site:' + host;

  if (query) {
    safeOpenUrl(uri);
  } else {
    Stun.utils.popAlert('warning', '请输入字符');
  }
}

var assistSearchList = window.CONFIG.assistSearch;

if (Array.isArray(assistSearchList)) {
  assistSearchList.forEach(function (name) {
    document.querySelector('.search-btns-item--' + name).addEventListener('click', function () {
      extSearch(name);
    }, false);
  });
}</script><script src="https://cdn.jsdelivr.net/npm/pjax@latest/pjax.min.js"></script><script>window.addEventListener('DOMContentLoaded', function () {
  var pjax = new Pjax({"selectors":["head title","#main",".pjax-reload",".header-inner"],"history":true,"scrollTo":false,"scrollRestoration":false,"cacheBust":false,"debug":false,"currentUrlFullReload":false,"timeout":0});
  // 加载进度条的计时器
  var loadingTimer = null;

  // 重置页面 Y 方向上的滚动偏移量
  document.addEventListener('pjax:send', function () {
    $('.header-nav-menu').removeClass('show');
    if (CONFIG.pjax && CONFIG.pjax.avoidBanner) {
      $('html').velocity('scroll', {
        duration: 500,
        offset: $('#header').height(),
        easing: 'easeInOutCubic'
      });
    }

    var loadingBarWidth = 20;
    var MAX_LOADING_WIDTH = 95;

    $('.loading-bar').addClass('loading');
    $('.loading-bar__progress').css('width', loadingBarWidth + '%');
    clearInterval(loadingTimer);
    loadingTimer = setInterval(function () {
      loadingBarWidth += 3;
      if (loadingBarWidth > MAX_LOADING_WIDTH) {
        loadingBarWidth = MAX_LOADING_WIDTH;
      }
      $('.loading-bar__progress').css('width', loadingBarWidth + '%');
    }, 500);
  }, false);

  window.addEventListener('pjax:complete', function () {
    clearInterval(loadingTimer);
    $('.loading-bar__progress').css('width', '100%');
    $('.loading-bar').removeClass('loading');
    setTimeout(function () {
      $('.loading-bar__progress').css('width', '0');
    }, 400);
    $('link[rel=prefetch], script[data-pjax-rm]').each(function () {
      $(this).remove();
    });
    $('script[data-pjax], #pjax-reload script').each(function () {
      $(this).parent().append($(this).remove());
    });

    if (Stun.utils.pjaxReloadBoot) {
      Stun.utils.pjaxReloadBoot();
    }
    if (Stun.utils.pjaxReloadScroll) {
      Stun.utils.pjaxReloadScroll();
    }
    if (Stun.utils.pjaxReloadSidebar) {
      Stun.utils.pjaxReloadSidebar();
    }
    if (true) {
      if (Stun.utils.pjaxReloadHeader) {
        Stun.utils.pjaxReloadHeader();
      }
      if (Stun.utils.pjaxReloadScrollIcon) {
        Stun.utils.pjaxReloadScrollIcon();
      }
      if (Stun.utils.pjaxReloadLocalSearch) {
        Stun.utils.pjaxReloadLocalSearch();
      }
    }
  }, false);
}, false);</script><div id="pjax-reload"><link href="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.css" rel="stylesheet" type="text/css"><link href="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/contrib/copy-tex.css" rel="stylesheet" type="text/css"><script src="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/contrib/copy-tex.min.js"></script><script src="https://cdn.jsdelivr.net/npm/quicklink@1.0.1/dist/quicklink.umd.js"></script><script>function initQuicklink() {
  quicklink({
    timeout: '10000',
    priority: true,
    ignores: [uri => uri.includes('#'), uri => uri === 'http://garfielder.com/post/2b3e24ae.html', /\/api\/?/,uri => uri.includes('.xml'),uri => uri.includes('.zip'),(uri, el) => el.hasAttribute('nofollow'),(uri, el) => el.hasAttribute('noprefetch')]
  });
}

if (true || false) {
  initQuicklink();
} else {
  window.addEventListener('DOMContentLoaded', initQuicklink, false);
}</script><script src="https://cdn.jsdelivr.net/gh/sukkaw/busuanzi@latest/bsz.pure.mini.js" async></script></div><script src="https://cdn.jsdelivr.net/npm/leancloud-storage@latest/dist/av-min.js"></script><script src="https://cdn.jsdelivr.net/npm/valine@latest/dist/Valine.min.js"></script><script data-pjax="">function loadValine () {
  var GUEST_INFO = ['nick', 'mail', 'link'];
  var guest_info = 'nick,mail,link';

  guest_info = guest_info.split(',').filter(function(item) {
    return GUEST_INFO.indexOf(item) > -1;
  });
  new Valine({
    el: '#valine-container',
    appId: '7QW51uURwmFEJVmXD4UC943o-gzGzoHsz',
    appKey: 'UTbCV1BcSh71YxpBEu7wG05I',
    notify: true,
    verify: true,
    placeholder: 'Comment...',
    avatar: 'mp',
    meta: guest_info,
    pageSize: '10' || 10,
    visitor: false,
    recordIP: false,
    lang: '' || 'zh-cn',
    path: window.location.pathname
  });
}

if (true) {
  loadValine();
} else {
  window.addEventListener('DOMContentLoaded', loadValine, false);
}</script><script src="/js/utils.js?v=2.6.2"></script><script src="/js/stun-boot.js?v=2.6.2"></script><script src="/js/scroll.js?v=2.6.2"></script><script src="/js/header.js?v=2.6.2"></script><script src="/js/sidebar.js?v=2.6.2"></script><script type="application/json" src="/search.json"></script></body></html>